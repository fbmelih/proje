<html>
<head>
<title>ui sql.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cf8e6d;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #6aab73;}
.s4 { color: #2aacb8;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
ui sql.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">tkinter </span><span class="s0">as </span><span class="s1">tk</span>
<span class="s0">from </span><span class="s1">tkinter </span><span class="s0">import </span><span class="s1">ttk</span>
<span class="s0">from </span><span class="s1">tkinter </span><span class="s0">import </span><span class="s1">messagebox</span>
<span class="s0">from </span><span class="s1">tkinter</span><span class="s2">.</span><span class="s1">simpledialog </span><span class="s0">import </span><span class="s1">askstring</span>
<span class="s0">from </span><span class="s1">tkinter </span><span class="s0">import </span><span class="s1">simpledialog</span><span class="s2">, </span><span class="s1">Listbox</span><span class="s2">, </span><span class="s1">Button</span>
<span class="s0">from </span><span class="s1">PIL </span><span class="s0">import </span><span class="s1">Image</span><span class="s2">, </span><span class="s1">ImageTk</span>
<span class="s0">from </span><span class="s1">tkinter </span><span class="s0">import </span><span class="s1">scrolledtext</span>
<span class="s0">import </span><span class="s1">psycopg2</span>
<span class="s0">from </span><span class="s1">psycopg2 </span><span class="s0">import </span><span class="s1">sql</span>
<span class="s0">from </span><span class="s1">datetime </span><span class="s0">import </span><span class="s1">date</span>
<span class="s0">from </span><span class="s1">datetime </span><span class="s0">import </span><span class="s1">datetime</span>


<span class="s1">db_params </span><span class="s2">= {</span>
    <span class="s3">'host'</span><span class="s2">: </span><span class="s3">'localhost'</span><span class="s2">,</span>
    <span class="s3">'port'</span><span class="s2">: </span><span class="s4">5432</span><span class="s2">,</span>
    <span class="s3">'database'</span><span class="s2">: </span><span class="s3">'postgres'</span><span class="s2">,</span>
    <span class="s3">'user'</span><span class="s2">: </span><span class="s3">'postgres'</span><span class="s2">,</span>
    <span class="s3">'password'</span><span class="s2">: </span><span class="s3">'password'</span><span class="s2">,</span>
<span class="s2">}</span>

<span class="s1">login_screen </span><span class="s2">= </span><span class="s0">None</span>
<span class="s1">welcome_screen </span><span class="s2">= </span><span class="s0">None</span>

<span class="s0">def </span><span class="s1">authenticate_user</span><span class="s2">(</span><span class="s1">username</span><span class="s2">, </span><span class="s1">password</span><span class="s2">):</span>
    <span class="s0">try</span><span class="s2">:</span>
        <span class="s1">connection </span><span class="s2">= </span><span class="s1">psycopg2</span><span class="s2">.</span><span class="s1">connect</span><span class="s2">(**</span><span class="s1">db_params</span><span class="s2">)</span>
        <span class="s1">cursor </span><span class="s2">= </span><span class="s1">connection</span><span class="s2">.</span><span class="s1">cursor</span><span class="s2">()</span>

        <span class="s1">query </span><span class="s2">= </span><span class="s1">sql</span><span class="s2">.</span><span class="s1">SQL</span><span class="s2">(</span><span class="s3">&quot;SELECT id, username, role FROM users WHERE username = %s AND password = %s&quot;</span><span class="s2">)</span>
        <span class="s1">cursor</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">(</span><span class="s1">query</span><span class="s2">, (</span><span class="s1">username</span><span class="s2">, </span><span class="s1">password</span><span class="s2">))</span>

        <span class="s1">result </span><span class="s2">= </span><span class="s1">cursor</span><span class="s2">.</span><span class="s1">fetchone</span><span class="s2">()</span>

        <span class="s1">cursor</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>
        <span class="s1">connection</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>

        <span class="s0">return </span><span class="s1">result</span>

    <span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e</span><span class="s2">:</span>
        <span class="s1">print</span><span class="s2">(</span><span class="s3">f&quot;Authentication failed: </span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>
        <span class="s0">return None</span>

<span class="s0">def </span><span class="s1">show_welcome_screen</span><span class="s2">(</span><span class="s1">user_id</span><span class="s2">, </span><span class="s1">username</span><span class="s2">, </span><span class="s1">role</span><span class="s2">):</span>
    <span class="s0">global </span><span class="s1">welcome_screen</span>
    <span class="s0">if </span><span class="s1">login_screen</span><span class="s2">:</span>
        <span class="s1">login_screen</span><span class="s2">.</span><span class="s1">withdraw</span><span class="s2">()</span>

    <span class="s1">welcome_screen </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">Toplevel</span><span class="s2">(</span><span class="s1">root</span><span class="s2">)</span>
    <span class="s1">welcome_screen</span><span class="s2">.</span><span class="s1">title</span><span class="s2">(</span><span class="s3">f&quot;Welcome, </span><span class="s0">{</span><span class="s1">username</span><span class="s0">}</span><span class="s3">!&quot;</span><span class="s2">)</span>

    <span class="s1">image_path </span><span class="s2">= </span><span class="s3">'C:/Users/metto/Documents/yıldız sigorta/anamenu.jpg'</span>
    <span class="s0">try</span><span class="s2">:</span>
        <span class="s1">image </span><span class="s2">= </span><span class="s1">Image</span><span class="s2">.</span><span class="s1">open</span><span class="s2">(</span><span class="s1">image_path</span><span class="s2">)</span>
        <span class="s1">photo </span><span class="s2">= </span><span class="s1">ImageTk</span><span class="s2">.</span><span class="s1">PhotoImage</span><span class="s2">(</span><span class="s1">image</span><span class="s2">)</span>
        <span class="s1">image_label </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">welcome_screen</span><span class="s2">, </span><span class="s1">image</span><span class="s2">=</span><span class="s1">photo</span><span class="s2">)</span>
        <span class="s1">image_label</span><span class="s2">.</span><span class="s1">photo </span><span class="s2">= </span><span class="s1">photo</span>
        <span class="s1">image_label</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">columnspan</span><span class="s2">=</span><span class="s4">3</span><span class="s2">)</span>
    <span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e</span><span class="s2">:</span>
        <span class="s1">print</span><span class="s2">(</span><span class="s3">f&quot;Error loading image: </span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>

    <span class="s1">welcome_label </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">welcome_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">f&quot;Welcome, </span><span class="s0">{</span><span class="s1">username</span><span class="s0">}</span><span class="s3">!</span><span class="s0">\n</span><span class="s3">Your role: </span><span class="s0">{</span><span class="s1">role</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>
    <span class="s1">welcome_label</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">columnspan</span><span class="s2">=</span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">if </span><span class="s1">role </span><span class="s2">== </span><span class="s3">'admin'</span><span class="s2">:</span>
        <span class="s1">create_user_button </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">welcome_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Create User&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">create_user</span><span class="s2">)</span>
        <span class="s1">create_user_button</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">delete_user_button </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">welcome_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Delete User&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">delete_user</span><span class="s2">)</span>
        <span class="s1">delete_user_button</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">show_all_users_button </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">welcome_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Show All Users&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">show_all_users</span><span class="s2">)</span>
        <span class="s1">show_all_users_button</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">add_customer_button </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">welcome_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Add Customer&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">add_customer</span><span class="s2">)</span>
        <span class="s1">add_customer_button</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">delete_customer_button </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">welcome_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Delete Customer&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">delete_customer</span><span class="s2">)</span>
        <span class="s1">delete_customer_button</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">show_customer_info_button </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">welcome_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Show Customer Info&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">show_customer_info</span><span class="s2">)</span>
        <span class="s1">show_customer_info_button</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">update_customer_button </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">welcome_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Update Customer&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">update_customer</span><span class="s2">)</span>
        <span class="s1">update_customer_button</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">4</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">find_policy_button </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">welcome_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Find Policy&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">find_policy</span><span class="s2">)</span>
        <span class="s1">find_policy_button</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">4</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">columnspan</span><span class="s2">=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">10</span><span class="s2">)</span>

        <span class="s1">reports_button </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">welcome_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Reports&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">show_reports</span><span class="s2">)</span>
        <span class="s1">reports_button</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">7</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">columnspan</span><span class="s2">=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">10</span><span class="s2">)</span>

        <span class="s1">enter_sales_button </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">welcome_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Enter Sales&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">enter_sales</span><span class="s2">)</span>
        <span class="s1">enter_sales_button</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">4</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

    <span class="s0">else</span><span class="s2">:</span>
        <span class="s1">create_user_button </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">welcome_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Create User&quot;</span><span class="s2">, </span><span class="s1">state</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">DISABLED</span><span class="s2">)</span>
        <span class="s1">create_user_button</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">delete_user_button </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">welcome_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Delete User&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">delete_user</span><span class="s2">, </span><span class="s1">state</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">DISABLED</span><span class="s2">)</span>
        <span class="s1">delete_user_button</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">show_all_users_button </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">welcome_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Show All Users&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">show_all_users</span><span class="s2">, </span><span class="s1">state</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">DISABLED</span><span class="s2">)</span>
        <span class="s1">show_all_users_button</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">add_customer_button </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">welcome_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Add Customer&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">add_customer</span><span class="s2">)</span>
        <span class="s1">add_customer_button</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">delete_customer_button </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">welcome_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Delete Customer&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">delete_customer</span><span class="s2">, </span><span class="s1">state</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">DISABLED</span><span class="s2">)</span>
        <span class="s1">delete_customer_button</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">show_customer_info_button </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">welcome_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Show Customer Info&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">show_customer_info</span><span class="s2">)</span>
        <span class="s1">show_customer_info_button</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">update_customer_button </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">welcome_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Update Customer&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">update_customer</span><span class="s2">)</span>
        <span class="s1">update_customer_button</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">4</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">find_policy_button </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">welcome_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Find Policy&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">find_policy</span><span class="s2">)</span>
        <span class="s1">find_policy_button</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">4</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">columnspan</span><span class="s2">=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">10</span><span class="s2">)</span>

        <span class="s1">reports_button </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">welcome_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Reports&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">show_reports</span><span class="s2">, </span><span class="s1">state</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">DISABLED</span><span class="s2">)</span>
        <span class="s1">reports_button</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">7</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">columnspan</span><span class="s2">=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">10</span><span class="s2">)</span>

        <span class="s1">enter_sales_button </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">welcome_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Enter Sales&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">enter_sales</span><span class="s2">)</span>
        <span class="s1">enter_sales_button</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">4</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

<span class="s0">def </span><span class="s1">create_user</span><span class="s2">():</span>
    <span class="s1">user_creation_screen </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">Toplevel</span><span class="s2">(</span><span class="s1">welcome_screen</span><span class="s2">)</span>
    <span class="s1">user_creation_screen</span><span class="s2">.</span><span class="s1">title</span><span class="s2">(</span><span class="s3">&quot;Create User&quot;</span><span class="s2">)</span>

    <span class="s1">username_label </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">user_creation_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Username:&quot;</span><span class="s2">)</span>
    <span class="s1">username_label</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
    <span class="s1">username_entry </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">user_creation_screen</span><span class="s2">)</span>
    <span class="s1">username_entry</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

    <span class="s1">password_label </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">user_creation_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Password:&quot;</span><span class="s2">)</span>
    <span class="s1">password_label</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
    <span class="s1">password_entry </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">user_creation_screen</span><span class="s2">, </span><span class="s1">show</span><span class="s2">=</span><span class="s3">&quot;*&quot;</span><span class="s2">)</span>
    <span class="s1">password_entry</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

    <span class="s1">role_label </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">user_creation_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Role:&quot;</span><span class="s2">)</span>
    <span class="s1">role_label</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
    <span class="s1">role_var </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">StringVar</span><span class="s2">(</span><span class="s1">user_creation_screen</span><span class="s2">)</span>
    <span class="s1">role_var</span><span class="s2">.</span><span class="s1">set</span><span class="s2">(</span><span class="s3">&quot;user&quot;</span><span class="s2">)</span>
    <span class="s1">role_dropdown </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Combobox</span><span class="s2">(</span><span class="s1">user_creation_screen</span><span class="s2">, </span><span class="s1">textvariable</span><span class="s2">=</span><span class="s1">role_var</span><span class="s2">, </span><span class="s1">values</span><span class="s2">=[</span><span class="s3">&quot;user&quot;</span><span class="s2">, </span><span class="s3">&quot;admin&quot;</span><span class="s2">])</span>
    <span class="s1">role_dropdown</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

    <span class="s1">submit_button </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">user_creation_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Submit&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s0">lambda</span><span class="s2">: </span><span class="s1">submit_user</span><span class="s2">(</span><span class="s1">username_entry</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(), </span><span class="s1">password_entry</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(), </span><span class="s1">role_var</span><span class="s2">.</span><span class="s1">get</span><span class="s2">()))</span>
    <span class="s1">submit_button</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">columnspan</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">10</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">delete_user</span><span class="s2">():</span>
    <span class="s0">try</span><span class="s2">:</span>
        <span class="s1">user_identifier </span><span class="s2">= </span><span class="s1">askstring</span><span class="s2">(</span><span class="s3">&quot;Delete User&quot;</span><span class="s2">, </span><span class="s3">&quot;Enter the ID of the user to delete:&quot;</span><span class="s2">)</span>

        <span class="s0">if </span><span class="s1">user_identifier </span><span class="s0">is not None</span><span class="s2">:</span>
            <span class="s1">connection </span><span class="s2">= </span><span class="s1">psycopg2</span><span class="s2">.</span><span class="s1">connect</span><span class="s2">(**</span><span class="s1">db_params</span><span class="s2">)</span>
            <span class="s1">cursor </span><span class="s2">= </span><span class="s1">connection</span><span class="s2">.</span><span class="s1">cursor</span><span class="s2">()</span>

            <span class="s1">query_check_user </span><span class="s2">= </span><span class="s1">sql</span><span class="s2">.</span><span class="s1">SQL</span><span class="s2">(</span><span class="s3">&quot;SELECT id FROM users WHERE id = %s OR username = %s&quot;</span><span class="s2">)</span>
            <span class="s1">cursor</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">(</span><span class="s1">query_check_user</span><span class="s2">, (</span><span class="s1">user_identifier</span><span class="s2">, </span><span class="s1">user_identifier</span><span class="s2">))</span>
            <span class="s1">user_exists </span><span class="s2">= </span><span class="s1">cursor</span><span class="s2">.</span><span class="s1">fetchone</span><span class="s2">()</span>

            <span class="s0">if </span><span class="s1">user_exists</span><span class="s2">:</span>
                <span class="s1">confirmation </span><span class="s2">= </span><span class="s1">messagebox</span><span class="s2">.</span><span class="s1">askyesno</span><span class="s2">(</span><span class="s3">&quot;Confirm Deletion&quot;</span><span class="s2">, </span><span class="s3">f&quot;Are you sure you want to delete the user with ID or username: </span><span class="s0">{</span><span class="s1">user_identifier</span><span class="s0">}</span><span class="s3">?&quot;</span><span class="s2">)</span>

                <span class="s0">if </span><span class="s1">confirmation</span><span class="s2">:</span>
                    <span class="s1">query_delete_user </span><span class="s2">= </span><span class="s1">sql</span><span class="s2">.</span><span class="s1">SQL</span><span class="s2">(</span><span class="s3">&quot;DELETE FROM users WHERE id = %s OR username = %s&quot;</span><span class="s2">)</span>
                    <span class="s1">cursor</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">(</span><span class="s1">query_delete_user</span><span class="s2">, (</span><span class="s1">user_identifier</span><span class="s2">, </span><span class="s1">user_identifier</span><span class="s2">))</span>

                    <span class="s1">connection</span><span class="s2">.</span><span class="s1">commit</span><span class="s2">()</span>
                    <span class="s1">cursor</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>
                    <span class="s1">connection</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>

                    <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showinfo</span><span class="s2">(</span><span class="s3">&quot;User Deleted&quot;</span><span class="s2">, </span><span class="s3">&quot;User deleted successfully!&quot;</span><span class="s2">)</span>
            <span class="s0">else</span><span class="s2">:</span>
                <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s3">&quot;User Not Found&quot;</span><span class="s2">, </span><span class="s3">f&quot;User with ID or username: </span><span class="s0">{</span><span class="s1">user_identifier</span><span class="s0">} </span><span class="s3">not found.&quot;</span><span class="s2">)</span>

    <span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e</span><span class="s2">:</span>
        <span class="s1">print</span><span class="s2">(</span><span class="s3">f&quot;Error deleting user: </span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>
        <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s3">&quot;Error&quot;</span><span class="s2">, </span><span class="s3">&quot;Error deleting user. Please try again.&quot;</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">show_all_users</span><span class="s2">():</span>
    <span class="s0">try</span><span class="s2">:</span>
        <span class="s1">connection </span><span class="s2">= </span><span class="s1">psycopg2</span><span class="s2">.</span><span class="s1">connect</span><span class="s2">(**</span><span class="s1">db_params</span><span class="s2">)</span>
        <span class="s1">cursor </span><span class="s2">= </span><span class="s1">connection</span><span class="s2">.</span><span class="s1">cursor</span><span class="s2">()</span>

        <span class="s1">query </span><span class="s2">= </span><span class="s1">sql</span><span class="s2">.</span><span class="s1">SQL</span><span class="s2">(</span><span class="s3">&quot;SELECT id, username, role FROM users&quot;</span><span class="s2">)</span>
        <span class="s1">cursor</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">(</span><span class="s1">query</span><span class="s2">)</span>

        <span class="s1">users </span><span class="s2">= </span><span class="s1">cursor</span><span class="s2">.</span><span class="s1">fetchall</span><span class="s2">()</span>

        <span class="s1">cursor</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>
        <span class="s1">connection</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>

        <span class="s1">user_list </span><span class="s2">= </span><span class="s3">&quot;</span><span class="s0">\n</span><span class="s3">&quot;</span><span class="s2">.</span><span class="s1">join</span><span class="s2">([</span><span class="s3">f&quot;ID: </span><span class="s0">{</span><span class="s1">user</span><span class="s2">[</span><span class="s4">0</span><span class="s2">]</span><span class="s0">}</span><span class="s3">, Username: </span><span class="s0">{</span><span class="s1">user</span><span class="s2">[</span><span class="s4">1</span><span class="s2">]</span><span class="s0">}</span><span class="s3">, Role: </span><span class="s0">{</span><span class="s1">user</span><span class="s2">[</span><span class="s4">2</span><span class="s2">]</span><span class="s0">}</span><span class="s3">&quot; </span><span class="s0">for </span><span class="s1">user </span><span class="s0">in </span><span class="s1">users</span><span class="s2">])</span>
        <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showinfo</span><span class="s2">(</span><span class="s3">&quot;All Users&quot;</span><span class="s2">, </span><span class="s3">f&quot;All Users:</span><span class="s0">\n{</span><span class="s1">user_list</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>

    <span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e</span><span class="s2">:</span>
        <span class="s1">print</span><span class="s2">(</span><span class="s3">f&quot;Error fetching users: </span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>
        <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s3">&quot;Error&quot;</span><span class="s2">, </span><span class="s3">&quot;Error fetching users. Please try again.&quot;</span><span class="s2">)</span>

<span class="s0">def </span><span class="s1">submit_user</span><span class="s2">(</span><span class="s1">username</span><span class="s2">, </span><span class="s1">password</span><span class="s2">, </span><span class="s1">role</span><span class="s2">):</span>
    <span class="s0">try</span><span class="s2">:</span>
        <span class="s1">connection </span><span class="s2">= </span><span class="s1">psycopg2</span><span class="s2">.</span><span class="s1">connect</span><span class="s2">(**</span><span class="s1">db_params</span><span class="s2">)</span>
        <span class="s1">cursor </span><span class="s2">= </span><span class="s1">connection</span><span class="s2">.</span><span class="s1">cursor</span><span class="s2">()</span>

        <span class="s1">query </span><span class="s2">= </span><span class="s1">sql</span><span class="s2">.</span><span class="s1">SQL</span><span class="s2">(</span><span class="s3">&quot;INSERT INTO users (username, password, role) VALUES (%s, %s, %s)&quot;</span><span class="s2">)</span>
        <span class="s1">cursor</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">(</span><span class="s1">query</span><span class="s2">, (</span><span class="s1">username</span><span class="s2">, </span><span class="s1">password</span><span class="s2">, </span><span class="s1">role</span><span class="s2">))</span>

        <span class="s1">connection</span><span class="s2">.</span><span class="s1">commit</span><span class="s2">()</span>
        <span class="s1">cursor</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>
        <span class="s1">connection</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>

        <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showinfo</span><span class="s2">(</span><span class="s3">&quot;User Created&quot;</span><span class="s2">, </span><span class="s3">&quot;User created successfully!&quot;</span><span class="s2">)</span>

    <span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e</span><span class="s2">:</span>
        <span class="s1">print</span><span class="s2">(</span><span class="s3">f&quot;Error creating user: </span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>
        <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s3">&quot;Error&quot;</span><span class="s2">, </span><span class="s3">&quot;Error creating user. Please try a different username.&quot;</span><span class="s2">)</span>



<span class="s0">def </span><span class="s1">login_clicked</span><span class="s2">():</span>
    <span class="s0">global </span><span class="s1">login_screen</span>
    <span class="s1">username </span><span class="s2">= </span><span class="s1">username_entry</span><span class="s2">.</span><span class="s1">get</span><span class="s2">()</span>
    <span class="s1">password </span><span class="s2">= </span><span class="s1">password_entry</span><span class="s2">.</span><span class="s1">get</span><span class="s2">()</span>

    <span class="s1">user_data </span><span class="s2">= </span><span class="s1">authenticate_user</span><span class="s2">(</span><span class="s1">username</span><span class="s2">, </span><span class="s1">password</span><span class="s2">)</span>

    <span class="s0">if </span><span class="s1">user_data</span><span class="s2">:</span>
        <span class="s1">user_id</span><span class="s2">, </span><span class="s1">username</span><span class="s2">, </span><span class="s1">role </span><span class="s2">= </span><span class="s1">user_data</span>
        <span class="s1">show_welcome_screen</span><span class="s2">(</span><span class="s1">user_id</span><span class="s2">, </span><span class="s1">username</span><span class="s2">, </span><span class="s1">role</span><span class="s2">)</span>
    <span class="s0">else</span><span class="s2">:</span>
        <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s3">&quot;Login Failed&quot;</span><span class="s2">, </span><span class="s3">&quot;Invalid credentials. Please try again.&quot;</span><span class="s2">)</span>



<span class="s0">def </span><span class="s1">add_customer</span><span class="s2">():</span>
    <span class="s0">try</span><span class="s2">:</span>
        <span class="s1">add_customer_screen </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">Toplevel</span><span class="s2">(</span><span class="s1">welcome_screen</span><span class="s2">)</span>
        <span class="s1">add_customer_screen</span><span class="s2">.</span><span class="s1">title</span><span class="s2">(</span><span class="s3">&quot;Add Customer&quot;</span><span class="s2">)</span>

        <span class="s0">global </span><span class="s1">customer_name_entry</span><span class="s2">, </span><span class="s1">customer_surname_entry</span><span class="s2">, </span><span class="s1">customer_age_entry</span><span class="s2">, </span><span class="s1">customer_location_entry</span><span class="s2">, </span><span class="s1">customer_state_entry</span><span class="s2">, </span><span class="s1">customer_postal_code_entry</span><span class="s2">, </span><span class="s1">customer_email_entry</span>

        <span class="s1">customer_name_label </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">add_customer_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Name:&quot;</span><span class="s2">)</span>
        <span class="s1">customer_name_label</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
        <span class="s1">customer_name_entry </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">add_customer_screen</span><span class="s2">)</span>
        <span class="s1">customer_name_entry</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">customer_surname_label </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">add_customer_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Surname:&quot;</span><span class="s2">)</span>
        <span class="s1">customer_surname_label</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
        <span class="s1">customer_surname_entry </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">add_customer_screen</span><span class="s2">)</span>
        <span class="s1">customer_surname_entry</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">customer_age_label </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">add_customer_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Age:&quot;</span><span class="s2">)</span>
        <span class="s1">customer_age_label</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
        <span class="s1">customer_age_entry </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">add_customer_screen</span><span class="s2">)</span>
        <span class="s1">customer_age_entry</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">customer_location_label </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">add_customer_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Location:&quot;</span><span class="s2">)</span>
        <span class="s1">customer_location_label</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
        <span class="s1">customer_location_entry </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">add_customer_screen</span><span class="s2">)</span>
        <span class="s1">customer_location_entry</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">customer_state_label </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">add_customer_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;State:&quot;</span><span class="s2">)</span>
        <span class="s1">customer_state_label</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">4</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
        <span class="s1">customer_state_entry </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">add_customer_screen</span><span class="s2">)</span>
        <span class="s1">customer_state_entry</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">4</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">customer_postal_code_label </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">add_customer_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Postal Code:&quot;</span><span class="s2">)</span>
        <span class="s1">customer_postal_code_label</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
        <span class="s1">customer_postal_code_entry </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">add_customer_screen</span><span class="s2">)</span>
        <span class="s1">customer_postal_code_entry</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">customer_email_label </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">add_customer_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Email:&quot;</span><span class="s2">)</span>
        <span class="s1">customer_email_label</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">6</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
        <span class="s1">customer_email_entry </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">add_customer_screen</span><span class="s2">)</span>
        <span class="s1">customer_email_entry</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">6</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s0">def </span><span class="s1">submit_customer</span><span class="s2">():</span>
            <span class="s0">try</span><span class="s2">:</span>
                <span class="s1">name </span><span class="s2">= </span><span class="s1">customer_name_entry</span><span class="s2">.</span><span class="s1">get</span><span class="s2">()</span>
                <span class="s1">surname </span><span class="s2">= </span><span class="s1">customer_surname_entry</span><span class="s2">.</span><span class="s1">get</span><span class="s2">()</span>
                <span class="s1">age </span><span class="s2">= </span><span class="s1">customer_age_entry</span><span class="s2">.</span><span class="s1">get</span><span class="s2">()</span>
                <span class="s1">location </span><span class="s2">= </span><span class="s1">customer_location_entry</span><span class="s2">.</span><span class="s1">get</span><span class="s2">()</span>
                <span class="s1">state </span><span class="s2">= </span><span class="s1">customer_state_entry</span><span class="s2">.</span><span class="s1">get</span><span class="s2">()</span>
                <span class="s1">postal_code </span><span class="s2">= </span><span class="s1">customer_postal_code_entry</span><span class="s2">.</span><span class="s1">get</span><span class="s2">()</span>
                <span class="s1">email </span><span class="s2">= </span><span class="s1">customer_email_entry</span><span class="s2">.</span><span class="s1">get</span><span class="s2">()</span>

                <span class="s0">if </span><span class="s1">name </span><span class="s0">and </span><span class="s1">surname </span><span class="s0">and </span><span class="s1">age</span><span class="s2">:</span>
                    <span class="s1">connection </span><span class="s2">= </span><span class="s1">psycopg2</span><span class="s2">.</span><span class="s1">connect</span><span class="s2">(**</span><span class="s1">db_params</span><span class="s2">)</span>
                    <span class="s1">cursor </span><span class="s2">= </span><span class="s1">connection</span><span class="s2">.</span><span class="s1">cursor</span><span class="s2">()</span>

                    <span class="s1">query_max_id </span><span class="s2">= </span><span class="s1">sql</span><span class="s2">.</span><span class="s1">SQL</span><span class="s2">(</span><span class="s3">&quot;SELECT MAX(customer_id) FROM customer&quot;</span><span class="s2">)</span>
                    <span class="s1">cursor</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">(</span><span class="s1">query_max_id</span><span class="s2">)</span>
                    <span class="s1">max_id </span><span class="s2">= </span><span class="s1">cursor</span><span class="s2">.</span><span class="s1">fetchone</span><span class="s2">()[</span><span class="s4">0</span><span class="s2">]</span>

                    <span class="s1">next_customer_id </span><span class="s2">= </span><span class="s1">max_id </span><span class="s2">+ </span><span class="s4">1 </span><span class="s0">if </span><span class="s1">max_id </span><span class="s0">is not None else </span><span class="s4">1</span>

                    <span class="s1">query_insert_customer </span><span class="s2">= </span><span class="s1">sql</span><span class="s2">.</span><span class="s1">SQL</span><span class="s2">(</span><span class="s3">&quot;INSERT INTO customer (customer_id, name, surname, age, location, state, postal_code, email) VALUES (%s, %s, %s, %s, %s, %s, %s, %s)&quot;</span><span class="s2">)</span>
                    <span class="s1">cursor</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">(</span><span class="s1">query_insert_customer</span><span class="s2">, (</span><span class="s1">next_customer_id</span><span class="s2">, </span><span class="s1">name</span><span class="s2">, </span><span class="s1">surname</span><span class="s2">, </span><span class="s1">age</span><span class="s2">, </span><span class="s1">location</span><span class="s2">, </span><span class="s1">state</span><span class="s2">, </span><span class="s1">postal_code</span><span class="s2">, </span><span class="s1">email</span><span class="s2">))</span>

                    <span class="s1">connection</span><span class="s2">.</span><span class="s1">commit</span><span class="s2">()</span>
                    <span class="s1">cursor</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>
                    <span class="s1">connection</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>

                    <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showinfo</span><span class="s2">(</span><span class="s3">&quot;Customer Added&quot;</span><span class="s2">, </span><span class="s3">f&quot;Customer added successfully!</span><span class="s0">\n</span><span class="s3">Customer ID: </span><span class="s0">{</span><span class="s1">next_customer_id</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>
                    <span class="s1">add_customer_screen</span><span class="s2">.</span><span class="s1">destroy</span><span class="s2">()</span>

                <span class="s0">else</span><span class="s2">:</span>
                    <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s3">&quot;Incomplete Information&quot;</span><span class="s2">, </span><span class="s3">&quot;Name, surname, and age are required fields. Please fill them in.&quot;</span><span class="s2">)</span>

            <span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e</span><span class="s2">:</span>
                <span class="s1">print</span><span class="s2">(</span><span class="s3">f&quot;Error adding customer: </span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>
                <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s3">&quot;Error&quot;</span><span class="s2">, </span><span class="s3">&quot;Error adding customer. Please try again.&quot;</span><span class="s2">)</span>

        <span class="s1">submit_button </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">add_customer_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Submit&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">submit_customer</span><span class="s2">)</span>
        <span class="s1">submit_button</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">7</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">columnspan</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">10</span><span class="s2">)</span>

    <span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e</span><span class="s2">:</span>
        <span class="s1">print</span><span class="s2">(</span><span class="s3">f&quot;Error opening add customer screen: </span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>
        <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s3">&quot;Error&quot;</span><span class="s2">, </span><span class="s3">&quot;Error opening add customer screen. Please try again.&quot;</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">show_customer_info</span><span class="s2">():</span>
    <span class="s0">try</span><span class="s2">:</span>
        <span class="s1">customer_info_screen </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">Toplevel</span><span class="s2">(</span><span class="s1">welcome_screen</span><span class="s2">)</span>
        <span class="s1">customer_info_screen</span><span class="s2">.</span><span class="s1">title</span><span class="s2">(</span><span class="s3">&quot;Customer Information&quot;</span><span class="s2">)</span>

        <span class="s1">customer_info_text </span><span class="s2">= </span><span class="s1">scrolledtext</span><span class="s2">.</span><span class="s1">ScrolledText</span><span class="s2">(</span><span class="s1">customer_info_screen</span><span class="s2">, </span><span class="s1">wrap</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">WORD</span><span class="s2">, </span><span class="s1">width</span><span class="s2">=</span><span class="s4">100</span><span class="s2">, </span><span class="s1">height</span><span class="s2">=</span><span class="s4">40</span><span class="s2">)</span>
        <span class="s1">customer_info_text</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">columnspan</span><span class="s2">=</span><span class="s4">3</span><span class="s2">)</span>

        <span class="s0">def </span><span class="s1">update_customer_info</span><span class="s2">():</span>
            <span class="s0">try</span><span class="s2">:</span>
                <span class="s1">connection </span><span class="s2">= </span><span class="s1">psycopg2</span><span class="s2">.</span><span class="s1">connect</span><span class="s2">(**</span><span class="s1">db_params</span><span class="s2">)</span>
                <span class="s1">cursor </span><span class="s2">= </span><span class="s1">connection</span><span class="s2">.</span><span class="s1">cursor</span><span class="s2">()</span>

                <span class="s1">query </span><span class="s2">= </span><span class="s1">sql</span><span class="s2">.</span><span class="s1">SQL</span><span class="s2">(</span><span class="s3">&quot;SELECT customer_id, name, surname, age, location, state, postal_code, email FROM customer&quot;</span><span class="s2">)</span>
                <span class="s1">cursor</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">(</span><span class="s1">query</span><span class="s2">)</span>

                <span class="s1">customers </span><span class="s2">= </span><span class="s1">cursor</span><span class="s2">.</span><span class="s1">fetchall</span><span class="s2">()</span>

                <span class="s1">cursor</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>
                <span class="s1">connection</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>

                <span class="s1">customer_info_text</span><span class="s2">.</span><span class="s1">delete</span><span class="s2">(</span><span class="s4">1.0</span><span class="s2">, </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">END</span><span class="s2">)</span>
                <span class="s0">for </span><span class="s1">customer </span><span class="s0">in </span><span class="s1">customers</span><span class="s2">:</span>
                    <span class="s1">customer_info_text</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">END</span><span class="s2">, </span><span class="s3">f&quot;</span><span class="s0">{</span><span class="s3">'='</span><span class="s2">*</span><span class="s4">30</span><span class="s0">}\n</span><span class="s3">&quot;</span><span class="s2">)</span>
                    <span class="s1">customer_info_text</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">END</span><span class="s2">, </span><span class="s3">f&quot;ID: </span><span class="s0">{</span><span class="s1">customer</span><span class="s2">[</span><span class="s4">0</span><span class="s2">]</span><span class="s0">}\n</span><span class="s3">&quot;</span><span class="s2">)</span>
                    <span class="s1">customer_info_text</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">END</span><span class="s2">, </span><span class="s3">f&quot;Name: </span><span class="s0">{</span><span class="s1">customer</span><span class="s2">[</span><span class="s4">1</span><span class="s2">]</span><span class="s0">}\n</span><span class="s3">&quot;</span><span class="s2">)</span>
                    <span class="s1">customer_info_text</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">END</span><span class="s2">, </span><span class="s3">f&quot;Surname: </span><span class="s0">{</span><span class="s1">customer</span><span class="s2">[</span><span class="s4">2</span><span class="s2">]</span><span class="s0">}\n</span><span class="s3">&quot;</span><span class="s2">)</span>
                    <span class="s1">customer_info_text</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">END</span><span class="s2">, </span><span class="s3">f&quot;Age: </span><span class="s0">{</span><span class="s1">customer</span><span class="s2">[</span><span class="s4">3</span><span class="s2">]</span><span class="s0">}\n</span><span class="s3">&quot;</span><span class="s2">)</span>
                    <span class="s1">customer_info_text</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">END</span><span class="s2">, </span><span class="s3">f&quot;Location: </span><span class="s0">{</span><span class="s1">customer</span><span class="s2">[</span><span class="s4">4</span><span class="s2">]</span><span class="s0">}\n</span><span class="s3">&quot;</span><span class="s2">)</span>
                    <span class="s1">customer_info_text</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">END</span><span class="s2">, </span><span class="s3">f&quot;State: </span><span class="s0">{</span><span class="s1">customer</span><span class="s2">[</span><span class="s4">5</span><span class="s2">]</span><span class="s0">}\n</span><span class="s3">&quot;</span><span class="s2">)</span>
                    <span class="s1">customer_info_text</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">END</span><span class="s2">, </span><span class="s3">f&quot;Postal Code: </span><span class="s0">{</span><span class="s1">customer</span><span class="s2">[</span><span class="s4">6</span><span class="s2">]</span><span class="s0">}\n</span><span class="s3">&quot;</span><span class="s2">)</span>
                    <span class="s1">customer_info_text</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">END</span><span class="s2">, </span><span class="s3">f&quot;Email: </span><span class="s0">{</span><span class="s1">customer</span><span class="s2">[</span><span class="s4">7</span><span class="s2">]</span><span class="s0">}\n\n</span><span class="s3">&quot;</span><span class="s2">)</span>

            <span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e</span><span class="s2">:</span>
                <span class="s1">print</span><span class="s2">(</span><span class="s3">f&quot;Error fetching customer information: </span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>
                <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s3">&quot;Error&quot;</span><span class="s2">, </span><span class="s3">&quot;Error fetching customer information. Please try again.&quot;</span><span class="s2">)</span>

        <span class="s0">def </span><span class="s1">show_customer_details</span><span class="s2">(</span><span class="s1">customer_id</span><span class="s2">):</span>
            <span class="s0">try</span><span class="s2">:</span>
                <span class="s1">connection </span><span class="s2">= </span><span class="s1">psycopg2</span><span class="s2">.</span><span class="s1">connect</span><span class="s2">(**</span><span class="s1">db_params</span><span class="s2">)</span>
                <span class="s1">cursor </span><span class="s2">= </span><span class="s1">connection</span><span class="s2">.</span><span class="s1">cursor</span><span class="s2">()</span>

                <span class="s1">query </span><span class="s2">= </span><span class="s1">sql</span><span class="s2">.</span><span class="s1">SQL</span><span class="s2">(</span><span class="s3">&quot;SELECT * FROM customer WHERE customer_id = %s&quot;</span><span class="s2">)</span>
                <span class="s1">cursor</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">(</span><span class="s1">query</span><span class="s2">, (</span><span class="s1">customer_id</span><span class="s2">,))</span>
                <span class="s1">customer_details </span><span class="s2">= </span><span class="s1">cursor</span><span class="s2">.</span><span class="s1">fetchone</span><span class="s2">()</span>

                <span class="s1">cursor</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>
                <span class="s1">connection</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>

                <span class="s1">customer_details_screen </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">Toplevel</span><span class="s2">(</span><span class="s1">customer_info_screen</span><span class="s2">)</span>
                <span class="s1">customer_details_screen</span><span class="s2">.</span><span class="s1">title</span><span class="s2">(</span><span class="s3">f&quot;Customer Details - ID: </span><span class="s0">{</span><span class="s1">customer_id</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>

                <span class="s1">details_text </span><span class="s2">= </span><span class="s1">scrolledtext</span><span class="s2">.</span><span class="s1">ScrolledText</span><span class="s2">(</span><span class="s1">customer_details_screen</span><span class="s2">, </span><span class="s1">wrap</span><span class="s2">=</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">WORD</span><span class="s2">, </span><span class="s1">width</span><span class="s2">=</span><span class="s4">80</span><span class="s2">, </span><span class="s1">height</span><span class="s2">=</span><span class="s4">20</span><span class="s2">)</span>
                <span class="s1">details_text</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">columnspan</span><span class="s2">=</span><span class="s4">3</span><span class="s2">)</span>

                <span class="s1">details_text</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">END</span><span class="s2">, </span><span class="s3">f&quot;</span><span class="s0">{</span><span class="s3">'='</span><span class="s2">*</span><span class="s4">30</span><span class="s0">}\n</span><span class="s3">&quot;</span><span class="s2">)</span>
                <span class="s0">for </span><span class="s1">index</span><span class="s2">, </span><span class="s1">value </span><span class="s0">in </span><span class="s1">enumerate</span><span class="s2">(</span><span class="s1">customer_details</span><span class="s2">):</span>
                    <span class="s1">details_text</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">END</span><span class="s2">, </span><span class="s3">f&quot;</span><span class="s0">{</span><span class="s1">cursor</span><span class="s2">.</span><span class="s1">description</span><span class="s2">[</span><span class="s1">index</span><span class="s2">].</span><span class="s1">name</span><span class="s0">}</span><span class="s3">: </span><span class="s0">{</span><span class="s1">value</span><span class="s0">}\n</span><span class="s3">&quot;</span><span class="s2">)</span>

            <span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e</span><span class="s2">:</span>
                <span class="s1">print</span><span class="s2">(</span><span class="s3">f&quot;Error fetching customer details: </span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>
                <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s3">&quot;Error&quot;</span><span class="s2">, </span><span class="s3">&quot;Error fetching customer details. Please try again.&quot;</span><span class="s2">)</span>

        <span class="s0">def </span><span class="s1">on_customer_click</span><span class="s2">(</span><span class="s1">event</span><span class="s2">):</span>
            <span class="s1">line_number </span><span class="s2">= </span><span class="s1">int</span><span class="s2">(</span><span class="s1">event</span><span class="s2">.</span><span class="s1">widget</span><span class="s2">.</span><span class="s1">index</span><span class="s2">(</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">CURRENT</span><span class="s2">).</span><span class="s1">split</span><span class="s2">(</span><span class="s3">'.'</span><span class="s2">)[</span><span class="s4">0</span><span class="s2">])</span>

            <span class="s1">selected_customer_info </span><span class="s2">= </span><span class="s1">customer_info_text</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(</span><span class="s3">f&quot;</span><span class="s0">{</span><span class="s1">line_number</span><span class="s0">}</span><span class="s3">.0&quot;</span><span class="s2">, </span><span class="s3">f&quot;</span><span class="s0">{</span><span class="s1">line_number</span><span class="s0">}</span><span class="s3">.end&quot;</span><span class="s2">).</span><span class="s1">split</span><span class="s2">(</span><span class="s3">':'</span><span class="s2">)</span>
            <span class="s0">if </span><span class="s1">len</span><span class="s2">(</span><span class="s1">selected_customer_info</span><span class="s2">) &gt;= </span><span class="s4">2</span><span class="s2">:</span>
                <span class="s1">customer_id </span><span class="s2">= </span><span class="s1">int</span><span class="s2">(</span><span class="s1">selected_customer_info</span><span class="s2">[</span><span class="s4">1</span><span class="s2">])</span>
                <span class="s1">show_customer_details</span><span class="s2">(</span><span class="s1">customer_id</span><span class="s2">)</span>

        <span class="s1">customer_info_text</span><span class="s2">.</span><span class="s1">bind</span><span class="s2">(</span><span class="s3">&quot;&lt;ButtonRelease-1&gt;&quot;</span><span class="s2">, </span><span class="s1">on_customer_click</span><span class="s2">)</span>

        <span class="s1">filter_frame </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Frame</span><span class="s2">(</span><span class="s1">customer_info_screen</span><span class="s2">)</span>
        <span class="s1">filter_frame</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;W&quot;</span><span class="s2">)</span>

        <span class="s1">filter_label </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">filter_frame</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Name or Surname:&quot;</span><span class="s2">)</span>
        <span class="s1">filter_label</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;W&quot;</span><span class="s2">)</span>

        <span class="s1">filter_entry </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">filter_frame</span><span class="s2">)</span>
        <span class="s1">filter_entry</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;W&quot;</span><span class="s2">)</span>

        <span class="s0">def </span><span class="s1">filter_customer_info</span><span class="s2">():</span>
            <span class="s0">try</span><span class="s2">:</span>
                <span class="s1">connection </span><span class="s2">= </span><span class="s1">psycopg2</span><span class="s2">.</span><span class="s1">connect</span><span class="s2">(**</span><span class="s1">db_params</span><span class="s2">)</span>
                <span class="s1">cursor </span><span class="s2">= </span><span class="s1">connection</span><span class="s2">.</span><span class="s1">cursor</span><span class="s2">()</span>

                <span class="s1">filter_term </span><span class="s2">= </span><span class="s1">filter_entry</span><span class="s2">.</span><span class="s1">get</span><span class="s2">()</span>

                <span class="s1">query_filter </span><span class="s2">= </span><span class="s1">sql</span><span class="s2">.</span><span class="s1">SQL</span><span class="s2">(</span><span class="s3">&quot;SELECT customer_id, name, surname, age, location, state, postal_code, email FROM customer &quot;</span>
                                       <span class="s3">&quot;WHERE LOWER(name) LIKE LOWER(%s) OR &quot;</span>
                                       <span class="s3">&quot;LOWER(surname) LIKE LOWER(%s)&quot;</span><span class="s2">)</span>
                <span class="s1">cursor</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">(</span><span class="s1">query_filter</span><span class="s2">, (</span><span class="s3">f&quot;%</span><span class="s0">{</span><span class="s1">filter_term</span><span class="s0">}</span><span class="s3">%&quot;</span><span class="s2">, </span><span class="s3">f&quot;%</span><span class="s0">{</span><span class="s1">filter_term</span><span class="s0">}</span><span class="s3">%&quot;</span><span class="s2">))</span>

                <span class="s1">filtered_customers </span><span class="s2">= </span><span class="s1">cursor</span><span class="s2">.</span><span class="s1">fetchall</span><span class="s2">()</span>

                <span class="s1">cursor</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>
                <span class="s1">connection</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>

                <span class="s1">customer_info_text</span><span class="s2">.</span><span class="s1">delete</span><span class="s2">(</span><span class="s4">1.0</span><span class="s2">, </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">END</span><span class="s2">)</span>
                <span class="s0">for </span><span class="s1">customer </span><span class="s0">in </span><span class="s1">filtered_customers</span><span class="s2">:</span>
                    <span class="s1">customer_info_text</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">END</span><span class="s2">, </span><span class="s3">f&quot;</span><span class="s0">{</span><span class="s3">'='</span><span class="s2">*</span><span class="s4">30</span><span class="s0">}\n</span><span class="s3">&quot;</span><span class="s2">)</span>
                    <span class="s1">customer_info_text</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">END</span><span class="s2">, </span><span class="s3">f&quot;ID: </span><span class="s0">{</span><span class="s1">customer</span><span class="s2">[</span><span class="s4">0</span><span class="s2">]</span><span class="s0">}\n</span><span class="s3">&quot;</span><span class="s2">)</span>
                    <span class="s1">customer_info_text</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">END</span><span class="s2">, </span><span class="s3">f&quot;Name: </span><span class="s0">{</span><span class="s1">customer</span><span class="s2">[</span><span class="s4">1</span><span class="s2">]</span><span class="s0">}\n</span><span class="s3">&quot;</span><span class="s2">)</span>
                    <span class="s1">customer_info_text</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">END</span><span class="s2">, </span><span class="s3">f&quot;Surname: </span><span class="s0">{</span><span class="s1">customer</span><span class="s2">[</span><span class="s4">2</span><span class="s2">]</span><span class="s0">}\n</span><span class="s3">&quot;</span><span class="s2">)</span>
                    <span class="s1">customer_info_text</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">END</span><span class="s2">, </span><span class="s3">f&quot;Age: </span><span class="s0">{</span><span class="s1">customer</span><span class="s2">[</span><span class="s4">3</span><span class="s2">]</span><span class="s0">}\n</span><span class="s3">&quot;</span><span class="s2">)</span>
                    <span class="s1">customer_info_text</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">END</span><span class="s2">, </span><span class="s3">f&quot;Location: </span><span class="s0">{</span><span class="s1">customer</span><span class="s2">[</span><span class="s4">4</span><span class="s2">]</span><span class="s0">}\n</span><span class="s3">&quot;</span><span class="s2">)</span>
                    <span class="s1">customer_info_text</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">END</span><span class="s2">, </span><span class="s3">f&quot;State: </span><span class="s0">{</span><span class="s1">customer</span><span class="s2">[</span><span class="s4">5</span><span class="s2">]</span><span class="s0">}\n</span><span class="s3">&quot;</span><span class="s2">)</span>
                    <span class="s1">customer_info_text</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">END</span><span class="s2">, </span><span class="s3">f&quot;Postal Code: </span><span class="s0">{</span><span class="s1">customer</span><span class="s2">[</span><span class="s4">6</span><span class="s2">]</span><span class="s0">}\n</span><span class="s3">&quot;</span><span class="s2">)</span>
                    <span class="s1">customer_info_text</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s1">tk</span><span class="s2">.</span><span class="s1">END</span><span class="s2">, </span><span class="s3">f&quot;Email: </span><span class="s0">{</span><span class="s1">customer</span><span class="s2">[</span><span class="s4">7</span><span class="s2">]</span><span class="s0">}\n\n</span><span class="s3">&quot;</span><span class="s2">)</span>

            <span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e</span><span class="s2">:</span>
                <span class="s1">print</span><span class="s2">(</span><span class="s3">f&quot;Error filtering customer information: </span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>
                <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s3">&quot;Error&quot;</span><span class="s2">, </span><span class="s3">&quot;Error filtering customer information. Please try again.&quot;</span><span class="s2">)</span>


        <span class="s1">filter_button </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">filter_frame</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Apply Filter&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">filter_customer_info</span><span class="s2">)</span>
        <span class="s1">filter_button</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;W&quot;</span><span class="s2">)</span>

        <span class="s1">update_button </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">customer_info_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Update&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">update_customer_info</span><span class="s2">)</span>
        <span class="s1">update_button</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">update_customer_info</span><span class="s2">()</span>

    <span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e</span><span class="s2">:</span>
        <span class="s1">print</span><span class="s2">(</span><span class="s3">f&quot;Error opening customer information screen: </span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>
        <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s3">&quot;Error&quot;</span><span class="s2">, </span><span class="s3">&quot;Error opening customer information screen. Please try again.&quot;</span><span class="s2">)</span>

<span class="s0">def </span><span class="s1">delete_customer</span><span class="s2">():</span>
    <span class="s0">try</span><span class="s2">:</span>
        <span class="s1">customer_id </span><span class="s2">= </span><span class="s1">askstring</span><span class="s2">(</span><span class="s3">&quot;Delete Customer&quot;</span><span class="s2">, </span><span class="s3">&quot;Enter the ID of the customer to delete:&quot;</span><span class="s2">)</span>

        <span class="s0">if </span><span class="s1">customer_id </span><span class="s0">is not None</span><span class="s2">:</span>
            <span class="s1">connection </span><span class="s2">= </span><span class="s1">psycopg2</span><span class="s2">.</span><span class="s1">connect</span><span class="s2">(**</span><span class="s1">db_params</span><span class="s2">)</span>
            <span class="s1">cursor </span><span class="s2">= </span><span class="s1">connection</span><span class="s2">.</span><span class="s1">cursor</span><span class="s2">()</span>

            <span class="s1">query_check_customer </span><span class="s2">= </span><span class="s1">sql</span><span class="s2">.</span><span class="s1">SQL</span><span class="s2">(</span><span class="s3">&quot;SELECT customer_id FROM customer WHERE customer_id = %s&quot;</span><span class="s2">)</span>
            <span class="s1">cursor</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">(</span><span class="s1">query_check_customer</span><span class="s2">, (</span><span class="s1">customer_id</span><span class="s2">,))</span>
            <span class="s1">customer_exists </span><span class="s2">= </span><span class="s1">cursor</span><span class="s2">.</span><span class="s1">fetchone</span><span class="s2">()</span>

            <span class="s0">if </span><span class="s1">customer_exists</span><span class="s2">:</span>
                <span class="s1">confirmation </span><span class="s2">= </span><span class="s1">messagebox</span><span class="s2">.</span><span class="s1">askyesno</span><span class="s2">(</span><span class="s3">&quot;Confirm Deletion&quot;</span><span class="s2">, </span><span class="s3">f&quot;Are you sure you want to delete customer with ID: </span><span class="s0">{</span><span class="s1">customer_id</span><span class="s0">}</span><span class="s3">?&quot;</span><span class="s2">)</span>

                <span class="s0">if </span><span class="s1">confirmation</span><span class="s2">:</span>
                    <span class="s1">query_delete_customer </span><span class="s2">= </span><span class="s1">sql</span><span class="s2">.</span><span class="s1">SQL</span><span class="s2">(</span><span class="s3">&quot;DELETE FROM customer WHERE customer_id = %s&quot;</span><span class="s2">)</span>
                    <span class="s1">cursor</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">(</span><span class="s1">query_delete_customer</span><span class="s2">, (</span><span class="s1">customer_id</span><span class="s2">,))</span>

                    <span class="s1">connection</span><span class="s2">.</span><span class="s1">commit</span><span class="s2">()</span>
                    <span class="s1">cursor</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>
                    <span class="s1">connection</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>

                    <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showinfo</span><span class="s2">(</span><span class="s3">&quot;Customer Deleted&quot;</span><span class="s2">, </span><span class="s3">f&quot;Customer with ID </span><span class="s0">{</span><span class="s1">customer_id</span><span class="s0">} </span><span class="s3">deleted successfully!&quot;</span><span class="s2">)</span>
            <span class="s0">else</span><span class="s2">:</span>
                <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s3">&quot;Customer Not Found&quot;</span><span class="s2">, </span><span class="s3">f&quot;Customer with ID </span><span class="s0">{</span><span class="s1">customer_id</span><span class="s0">} </span><span class="s3">not found.&quot;</span><span class="s2">)</span>

    <span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e</span><span class="s2">:</span>
        <span class="s1">print</span><span class="s2">(</span><span class="s3">f&quot;Error deleting customer: </span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>
        <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s3">&quot;Error&quot;</span><span class="s2">, </span><span class="s3">&quot;Error deleting customer. Please try again.&quot;</span><span class="s2">)</span>

<span class="s0">def </span><span class="s1">update_customer</span><span class="s2">():</span>
    <span class="s0">try</span><span class="s2">:</span>
        <span class="s1">customer_id </span><span class="s2">= </span><span class="s1">askstring</span><span class="s2">(</span><span class="s3">&quot;Update Customer&quot;</span><span class="s2">, </span><span class="s3">&quot;Enter the ID of the customer to update:&quot;</span><span class="s2">)</span>

        <span class="s0">if </span><span class="s1">customer_id </span><span class="s0">is not None</span><span class="s2">:</span>
            <span class="s1">connection </span><span class="s2">= </span><span class="s1">psycopg2</span><span class="s2">.</span><span class="s1">connect</span><span class="s2">(**</span><span class="s1">db_params</span><span class="s2">)</span>
            <span class="s1">cursor </span><span class="s2">= </span><span class="s1">connection</span><span class="s2">.</span><span class="s1">cursor</span><span class="s2">()</span>

            <span class="s1">query_check_customer </span><span class="s2">= </span><span class="s1">sql</span><span class="s2">.</span><span class="s1">SQL</span><span class="s2">(</span><span class="s3">&quot;SELECT customer_id FROM customer WHERE customer_id = %s&quot;</span><span class="s2">)</span>
            <span class="s1">cursor</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">(</span><span class="s1">query_check_customer</span><span class="s2">, (</span><span class="s1">customer_id</span><span class="s2">,))</span>
            <span class="s1">customer_exists </span><span class="s2">= </span><span class="s1">cursor</span><span class="s2">.</span><span class="s1">fetchone</span><span class="s2">()</span>

            <span class="s1">cursor</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>
            <span class="s1">connection</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>

            <span class="s0">if </span><span class="s1">customer_exists</span><span class="s2">:</span>
                <span class="s1">update_customer_info_popup</span><span class="s2">(</span><span class="s1">customer_id</span><span class="s2">)</span>
            <span class="s0">else</span><span class="s2">:</span>
                <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s3">&quot;Customer Not Found&quot;</span><span class="s2">, </span><span class="s3">f&quot;Customer with ID </span><span class="s0">{</span><span class="s1">customer_id</span><span class="s0">} </span><span class="s3">not found.&quot;</span><span class="s2">)</span>

    <span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e</span><span class="s2">:</span>
        <span class="s1">print</span><span class="s2">(</span><span class="s3">f&quot;Error updating customer: </span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>
        <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s3">&quot;Error&quot;</span><span class="s2">, </span><span class="s3">&quot;Error updating customer. Please try again.&quot;</span><span class="s2">)</span>

<span class="s0">def </span><span class="s1">update_customer_info_popup</span><span class="s2">(</span><span class="s1">customer_id</span><span class="s2">):</span>
    <span class="s0">try</span><span class="s2">:</span>
        <span class="s1">update_customer_screen </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">Toplevel</span><span class="s2">(</span><span class="s1">welcome_screen</span><span class="s2">)</span>
        <span class="s1">update_customer_screen</span><span class="s2">.</span><span class="s1">title</span><span class="s2">(</span><span class="s3">f&quot;Update Customer - ID: </span><span class="s0">{</span><span class="s1">customer_id</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>


        <span class="s1">connection </span><span class="s2">= </span><span class="s1">psycopg2</span><span class="s2">.</span><span class="s1">connect</span><span class="s2">(**</span><span class="s1">db_params</span><span class="s2">)</span>
        <span class="s1">cursor </span><span class="s2">= </span><span class="s1">connection</span><span class="s2">.</span><span class="s1">cursor</span><span class="s2">()</span>

        <span class="s1">query_get_customer </span><span class="s2">= </span><span class="s1">sql</span><span class="s2">.</span><span class="s1">SQL</span><span class="s2">(</span><span class="s3">&quot;SELECT name, surname, age, location FROM customer WHERE customer_id = %s&quot;</span><span class="s2">)</span>
        <span class="s1">cursor</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">(</span><span class="s1">query_get_customer</span><span class="s2">, (</span><span class="s1">customer_id</span><span class="s2">,))</span>
        <span class="s1">customer_info </span><span class="s2">= </span><span class="s1">cursor</span><span class="s2">.</span><span class="s1">fetchone</span><span class="s2">()</span>

        <span class="s1">cursor</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>
        <span class="s1">connection</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>

        <span class="s0">if </span><span class="s1">customer_info</span><span class="s2">:</span>
            <span class="s1">updated_name_label </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">update_customer_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Name:&quot;</span><span class="s2">)</span>
            <span class="s1">updated_name_label</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
            <span class="s1">updated_name_entry </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">update_customer_screen</span><span class="s2">)</span>
            <span class="s1">updated_name_entry</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>
            <span class="s1">updated_name_entry</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s1">customer_info</span><span class="s2">[</span><span class="s4">0</span><span class="s2">])</span>

            <span class="s1">updated_surname_label </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">update_customer_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Surname:&quot;</span><span class="s2">)</span>
            <span class="s1">updated_surname_label</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
            <span class="s1">updated_surname_entry </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">update_customer_screen</span><span class="s2">)</span>
            <span class="s1">updated_surname_entry</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>
            <span class="s1">updated_surname_entry</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s1">customer_info</span><span class="s2">[</span><span class="s4">1</span><span class="s2">])</span>

            <span class="s1">updated_age_label </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">update_customer_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Age:&quot;</span><span class="s2">)</span>
            <span class="s1">updated_age_label</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
            <span class="s1">updated_age_entry </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">update_customer_screen</span><span class="s2">)</span>
            <span class="s1">updated_age_entry</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>
            <span class="s1">updated_age_entry</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s1">customer_info</span><span class="s2">[</span><span class="s4">2</span><span class="s2">])</span>

            <span class="s1">updated_location_label </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">update_customer_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Location:&quot;</span><span class="s2">)</span>
            <span class="s1">updated_location_label</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
            <span class="s1">updated_location_entry </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">update_customer_screen</span><span class="s2">)</span>
            <span class="s1">updated_location_entry</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>
            <span class="s1">updated_location_entry</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s1">customer_info</span><span class="s2">[</span><span class="s4">3</span><span class="s2">])</span>


            <span class="s0">def </span><span class="s1">submit_updated_customer</span><span class="s2">():</span>
                <span class="s0">try</span><span class="s2">:</span>

                    <span class="s1">updated_name </span><span class="s2">= </span><span class="s1">updated_name_entry</span><span class="s2">.</span><span class="s1">get</span><span class="s2">()</span>
                    <span class="s1">updated_surname </span><span class="s2">= </span><span class="s1">updated_surname_entry</span><span class="s2">.</span><span class="s1">get</span><span class="s2">()</span>
                    <span class="s1">updated_age </span><span class="s2">= </span><span class="s1">updated_age_entry</span><span class="s2">.</span><span class="s1">get</span><span class="s2">()</span>
                    <span class="s1">updated_location </span><span class="s2">= </span><span class="s1">updated_location_entry</span><span class="s2">.</span><span class="s1">get</span><span class="s2">()</span>

                    <span class="s0">if </span><span class="s1">updated_name </span><span class="s0">and </span><span class="s1">updated_surname </span><span class="s0">and </span><span class="s1">updated_age</span><span class="s2">:</span>

                        <span class="s1">connection </span><span class="s2">= </span><span class="s1">psycopg2</span><span class="s2">.</span><span class="s1">connect</span><span class="s2">(**</span><span class="s1">db_params</span><span class="s2">)</span>
                        <span class="s1">cursor </span><span class="s2">= </span><span class="s1">connection</span><span class="s2">.</span><span class="s1">cursor</span><span class="s2">()</span>

                        <span class="s1">query_update_customer </span><span class="s2">= </span><span class="s1">sql</span><span class="s2">.</span><span class="s1">SQL</span><span class="s2">(</span><span class="s3">&quot;UPDATE customer SET name = %s, surname = %s, age = %s, &quot;</span>
                                                        <span class="s3">&quot;location = %s &quot;</span>
                                                        <span class="s3">&quot;WHERE customer_id = %s&quot;</span><span class="s2">)</span>
                        <span class="s1">cursor</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">(</span><span class="s1">query_update_customer</span><span class="s2">, (</span><span class="s1">updated_name</span><span class="s2">, </span><span class="s1">updated_surname</span><span class="s2">, </span><span class="s1">updated_age</span><span class="s2">,</span>
                                                               <span class="s1">updated_location</span><span class="s2">, </span><span class="s1">customer_id</span><span class="s2">))</span>

                        <span class="s1">connection</span><span class="s2">.</span><span class="s1">commit</span><span class="s2">()</span>
                        <span class="s1">cursor</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>
                        <span class="s1">connection</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>

                        <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showinfo</span><span class="s2">(</span><span class="s3">&quot;Customer Updated&quot;</span><span class="s2">, </span><span class="s3">f&quot;Customer with ID </span><span class="s0">{</span><span class="s1">customer_id</span><span class="s0">} </span><span class="s3">updated successfully!&quot;</span><span class="s2">)</span>
                        <span class="s1">update_customer_screen</span><span class="s2">.</span><span class="s1">destroy</span><span class="s2">()</span>

                    <span class="s0">else</span><span class="s2">:</span>
                        <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s3">&quot;Incomplete Information&quot;</span><span class="s2">, </span><span class="s3">&quot;Name, surname, and age are required fields. Please fill them in.&quot;</span><span class="s2">)</span>

                <span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e</span><span class="s2">:</span>
                    <span class="s1">print</span><span class="s2">(</span><span class="s3">f&quot;Error updating customer: </span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>
                    <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s3">&quot;Error&quot;</span><span class="s2">, </span><span class="s3">&quot;Error updating customer. Please try again.&quot;</span><span class="s2">)</span>


            <span class="s1">update_button </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">update_customer_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Update&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">submit_updated_customer</span><span class="s2">)</span>
            <span class="s1">update_button</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">7</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">columnspan</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">10</span><span class="s2">)</span>

        <span class="s0">else</span><span class="s2">:</span>
            <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s3">&quot;Customer Not Found&quot;</span><span class="s2">, </span><span class="s3">f&quot;Customer with ID </span><span class="s0">{</span><span class="s1">customer_id</span><span class="s0">} </span><span class="s3">not found.&quot;</span><span class="s2">)</span>

    <span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e</span><span class="s2">:</span>
        <span class="s1">print</span><span class="s2">(</span><span class="s3">f&quot;Error opening update customer screen: </span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>
        <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s3">&quot;Error&quot;</span><span class="s2">, </span><span class="s3">&quot;Error opening update customer screen. Please try again.&quot;</span><span class="s2">)</span>

<span class="s0">def </span><span class="s1">find_policy</span><span class="s2">():</span>
    <span class="s0">try</span><span class="s2">:</span>
        <span class="s1">policy_id </span><span class="s2">= </span><span class="s1">askstring</span><span class="s2">(</span><span class="s3">&quot;Find Policy&quot;</span><span class="s2">, </span><span class="s3">&quot;Enter the ID of the policy to find:&quot;</span><span class="s2">)</span>

        <span class="s0">if </span><span class="s1">policy_id </span><span class="s0">is not None</span><span class="s2">:</span>
            <span class="s1">connection </span><span class="s2">= </span><span class="s1">psycopg2</span><span class="s2">.</span><span class="s1">connect</span><span class="s2">(**</span><span class="s1">db_params</span><span class="s2">)</span>
            <span class="s1">cursor </span><span class="s2">= </span><span class="s1">connection</span><span class="s2">.</span><span class="s1">cursor</span><span class="s2">()</span>

            <span class="s1">query_find_policy </span><span class="s2">= </span><span class="s1">sql</span><span class="s2">.</span><span class="s1">SQL</span><span class="s2">(</span><span class="s3">&quot;SELECT * FROM ins_policy WHERE policy_id = %s&quot;</span><span class="s2">)</span>
            <span class="s1">cursor</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">(</span><span class="s1">query_find_policy</span><span class="s2">, (</span><span class="s1">policy_id</span><span class="s2">,))</span>
            <span class="s1">policy_info </span><span class="s2">= </span><span class="s1">cursor</span><span class="s2">.</span><span class="s1">fetchone</span><span class="s2">()</span>

            <span class="s1">cursor</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>
            <span class="s1">connection</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>

            <span class="s0">if </span><span class="s1">policy_info</span><span class="s2">:</span>
                <span class="s1">show_policy_info_popup</span><span class="s2">(</span><span class="s1">policy_info</span><span class="s2">)</span>
            <span class="s0">else</span><span class="s2">:</span>
                <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s3">&quot;Policy Not Found&quot;</span><span class="s2">, </span><span class="s3">f&quot;Policy with ID </span><span class="s0">{</span><span class="s1">policy_id</span><span class="s0">} </span><span class="s3">not found.&quot;</span><span class="s2">)</span>

    <span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e</span><span class="s2">:</span>
        <span class="s1">print</span><span class="s2">(</span><span class="s3">f&quot;Error finding policy: </span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>
        <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s3">&quot;Error&quot;</span><span class="s2">, </span><span class="s3">&quot;Error finding policy. Please try again.&quot;</span><span class="s2">)</span>

<span class="s0">def </span><span class="s1">show_policy_info_popup</span><span class="s2">(</span><span class="s1">policy_info</span><span class="s2">):</span>
    <span class="s0">try</span><span class="s2">:</span>
        <span class="s1">policy_info_screen </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">Toplevel</span><span class="s2">(</span><span class="s1">welcome_screen</span><span class="s2">)</span>
        <span class="s1">policy_info_screen</span><span class="s2">.</span><span class="s1">title</span><span class="s2">(</span><span class="s3">f&quot;Policy Information - ID: </span><span class="s0">{</span><span class="s1">policy_info</span><span class="s2">[</span><span class="s4">0</span><span class="s2">]</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>

        <span class="s1">policy_id_label </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">policy_info_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Policy ID:&quot;</span><span class="s2">)</span>
        <span class="s1">policy_id_label</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
        <span class="s1">policy_id_value </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">policy_info_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s1">policy_info</span><span class="s2">[</span><span class="s4">0</span><span class="s2">])</span>
        <span class="s1">policy_id_value</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">policy_id_label </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">policy_info_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Policy Type:&quot;</span><span class="s2">)</span>
        <span class="s1">policy_id_label</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
        <span class="s1">policy_id_value </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">policy_info_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s1">policy_info</span><span class="s2">[</span><span class="s4">1</span><span class="s2">])</span>
        <span class="s1">policy_id_value</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">policy_id_label </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">policy_info_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Insurance Commusion:&quot; &quot; (TRY)&quot;</span><span class="s2">)</span>
        <span class="s1">policy_id_label</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
        <span class="s1">policy_id_value </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">policy_info_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s1">policy_info</span><span class="s2">[</span><span class="s4">2</span><span class="s2">])</span>
        <span class="s1">policy_id_value</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">policy_id_label </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">policy_info_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Insured Risk: &quot; &quot; (TRY)&quot;</span><span class="s2">)</span>
        <span class="s1">policy_id_label</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
        <span class="s1">policy_id_value </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">policy_info_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s1">policy_info</span><span class="s2">[</span><span class="s4">3</span><span class="s2">])</span>
        <span class="s1">policy_id_value</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">policy_id_label </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">policy_info_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Start Date:&quot;</span><span class="s2">)</span>
        <span class="s1">policy_id_label</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">4</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
        <span class="s1">policy_id_value </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">policy_info_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s1">policy_info</span><span class="s2">[</span><span class="s4">4</span><span class="s2">])</span>
        <span class="s1">policy_id_value</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">4</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">policy_id_label </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">policy_info_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Insurance Company ID:&quot;</span><span class="s2">)</span>
        <span class="s1">policy_id_label</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
        <span class="s1">policy_id_value </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">policy_info_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s1">policy_info</span><span class="s2">[</span><span class="s4">5</span><span class="s2">])</span>
        <span class="s1">policy_id_value</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">policy_id_label </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">policy_info_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Insurance Premium:&quot; &quot; (TRY)&quot;</span><span class="s2">)</span>
        <span class="s1">policy_id_label</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">6</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
        <span class="s1">policy_id_value </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">policy_info_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s1">policy_info</span><span class="s2">[</span><span class="s4">6</span><span class="s2">])</span>
        <span class="s1">policy_id_value</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">6</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">policy_id_label </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">policy_info_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Earthquake Coverage:&quot;</span><span class="s2">)</span>
        <span class="s1">policy_id_label</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">7</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
        <span class="s1">policy_id_value </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">policy_info_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s1">policy_info</span><span class="s2">[</span><span class="s4">7</span><span class="s2">])</span>
        <span class="s1">policy_id_value</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">7</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">policy_id_label </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">policy_info_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Flood Coverage:&quot;</span><span class="s2">)</span>
        <span class="s1">policy_id_label</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">8</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
        <span class="s1">policy_id_value </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">policy_info_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s1">policy_info</span><span class="s2">[</span><span class="s4">8</span><span class="s2">])</span>
        <span class="s1">policy_id_value</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">8</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">policy_id_label </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">policy_info_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Customer ID Number:&quot;</span><span class="s2">)</span>
        <span class="s1">policy_id_label</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">9</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
        <span class="s1">policy_id_value </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">policy_info_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s1">policy_info</span><span class="s2">[</span><span class="s4">9</span><span class="s2">])</span>
        <span class="s1">policy_id_value</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">9</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>


    <span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e</span><span class="s2">:</span>
        <span class="s1">print</span><span class="s2">(</span><span class="s3">f&quot;Error displaying policy information: </span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>
        <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s3">&quot;Error&quot;</span><span class="s2">, </span><span class="s3">&quot;Error displaying policy information. Please try again.&quot;</span><span class="s2">)</span>

<span class="s0">def </span><span class="s1">show_reports</span><span class="s2">():</span>
    <span class="s0">try</span><span class="s2">:</span>
        <span class="s1">reports_screen </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">Toplevel</span><span class="s2">(</span><span class="s1">welcome_screen</span><span class="s2">)</span>
        <span class="s1">reports_screen</span><span class="s2">.</span><span class="s1">title</span><span class="s2">(</span><span class="s3">&quot;Reports&quot;</span><span class="s2">)</span>

        <span class="s1">instruction_label </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">reports_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Select a report to view:&quot;</span><span class="s2">)</span>
        <span class="s1">instruction_label</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>


        <span class="s1">report_options </span><span class="s2">= [</span><span class="s3">&quot;customers_paid_premiums&quot;</span><span class="s2">, </span><span class="s3">&quot;customer_policies_details&quot;</span><span class="s2">, </span><span class="s3">&quot;branch_performance&quot;</span><span class="s2">]</span>
        <span class="s1">selected_report </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">StringVar</span><span class="s2">()</span>
        <span class="s1">report_combobox </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Combobox</span><span class="s2">(</span><span class="s1">reports_screen</span><span class="s2">, </span><span class="s1">textvariable</span><span class="s2">=</span><span class="s1">selected_report</span><span class="s2">, </span><span class="s1">values</span><span class="s2">=</span><span class="s1">report_options</span><span class="s2">)</span>
        <span class="s1">report_combobox</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>


        <span class="s0">def </span><span class="s1">show_selected_report</span><span class="s2">():</span>
            <span class="s0">try</span><span class="s2">:</span>

                <span class="s1">selected_view </span><span class="s2">= </span><span class="s1">selected_report</span><span class="s2">.</span><span class="s1">get</span><span class="s2">()</span>

                <span class="s1">connection </span><span class="s2">= </span><span class="s1">psycopg2</span><span class="s2">.</span><span class="s1">connect</span><span class="s2">(**</span><span class="s1">db_params</span><span class="s2">)</span>
                <span class="s1">cursor </span><span class="s2">= </span><span class="s1">connection</span><span class="s2">.</span><span class="s1">cursor</span><span class="s2">()</span>

                <span class="s1">query </span><span class="s2">= </span><span class="s1">sql</span><span class="s2">.</span><span class="s1">SQL</span><span class="s2">(</span><span class="s3">&quot;SELECT * FROM {}&quot;</span><span class="s2">).</span><span class="s1">format</span><span class="s2">(</span><span class="s1">sql</span><span class="s2">.</span><span class="s1">Identifier</span><span class="s2">(</span><span class="s1">selected_view</span><span class="s2">))</span>
                <span class="s1">cursor</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">(</span><span class="s1">query</span><span class="s2">)</span>

                <span class="s1">result </span><span class="s2">= </span><span class="s1">cursor</span><span class="s2">.</span><span class="s1">fetchall</span><span class="s2">()</span>

                <span class="s1">cursor</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>
                <span class="s1">connection</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>

                <span class="s1">report_display_screen </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">Toplevel</span><span class="s2">(</span><span class="s1">welcome_screen</span><span class="s2">)</span>
                <span class="s1">report_display_screen</span><span class="s2">.</span><span class="s1">title</span><span class="s2">(</span><span class="s3">f&quot;Report - </span><span class="s0">{</span><span class="s1">selected_view</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>


                <span class="s1">find_entry_label </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">report_display_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Find Customer:&quot;</span><span class="s2">)</span>
                <span class="s1">find_entry_label</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
                <span class="s1">find_entry </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">report_display_screen</span><span class="s2">)</span>
                <span class="s1">find_entry</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

                <span class="s1">find_button </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">report_display_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Find&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s0">lambda</span><span class="s2">: </span><span class="s1">filter_report</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">find_entry</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(), </span><span class="s1">tree</span><span class="s2">))</span>
                <span class="s1">find_button</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>


                <span class="s1">tree </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Treeview</span><span class="s2">(</span><span class="s1">report_display_screen</span><span class="s2">, </span><span class="s1">columns</span><span class="s2">=</span><span class="s1">list</span><span class="s2">(</span><span class="s1">range</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">result</span><span class="s2">[</span><span class="s4">0</span><span class="s2">]))), </span><span class="s1">show</span><span class="s2">=</span><span class="s3">&quot;headings&quot;</span><span class="s2">)</span>

                <span class="s0">for </span><span class="s1">col_index</span><span class="s2">, </span><span class="s1">col_name </span><span class="s0">in </span><span class="s1">enumerate</span><span class="s2">(</span><span class="s1">cursor</span><span class="s2">.</span><span class="s1">description</span><span class="s2">):</span>
                    <span class="s1">tree</span><span class="s2">.</span><span class="s1">heading</span><span class="s2">(</span><span class="s1">col_index</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s1">col_name</span><span class="s2">[</span><span class="s4">0</span><span class="s2">])</span>

                <span class="s0">for </span><span class="s1">row </span><span class="s0">in </span><span class="s1">result</span><span class="s2">:</span>
                    <span class="s1">tree</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s3">&quot;&quot;</span><span class="s2">, </span><span class="s3">&quot;end&quot;</span><span class="s2">, </span><span class="s1">values</span><span class="s2">=</span><span class="s1">row</span><span class="s2">)</span>

                <span class="s1">tree</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">columnspan</span><span class="s2">=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;nsew&quot;</span><span class="s2">)</span>
                <span class="s1">report_display_screen</span><span class="s2">.</span><span class="s1">grid_rowconfigure</span><span class="s2">(</span><span class="s4">1</span><span class="s2">, </span><span class="s1">weight</span><span class="s2">=</span><span class="s4">1</span><span class="s2">)</span>
                <span class="s1">report_display_screen</span><span class="s2">.</span><span class="s1">grid_columnconfigure</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s1">weight</span><span class="s2">=</span><span class="s4">1</span><span class="s2">)</span>

            <span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e</span><span class="s2">:</span>
                <span class="s1">print</span><span class="s2">(</span><span class="s3">f&quot;Error fetching report: </span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>
                <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s3">&quot;Error&quot;</span><span class="s2">, </span><span class="s3">&quot;Error fetching report. Please try again.&quot;</span><span class="s2">)</span>


        <span class="s0">def </span><span class="s1">filter_report</span><span class="s2">(</span><span class="s1">report_data</span><span class="s2">, </span><span class="s1">filter_text</span><span class="s2">, </span><span class="s1">treeview</span><span class="s2">):</span>
            <span class="s1">filtered_data </span><span class="s2">= [</span><span class="s1">row </span><span class="s0">for </span><span class="s1">row </span><span class="s0">in </span><span class="s1">report_data </span><span class="s0">if </span><span class="s1">filter_text</span><span class="s2">.</span><span class="s1">lower</span><span class="s2">() </span><span class="s0">in </span><span class="s3">&quot; &quot;</span><span class="s2">.</span><span class="s1">join</span><span class="s2">(</span><span class="s1">map</span><span class="s2">(</span><span class="s1">str</span><span class="s2">, </span><span class="s1">row</span><span class="s2">)).</span><span class="s1">lower</span><span class="s2">()]</span>


            <span class="s0">for </span><span class="s1">item </span><span class="s0">in </span><span class="s1">treeview</span><span class="s2">.</span><span class="s1">get_children</span><span class="s2">():</span>
                <span class="s1">treeview</span><span class="s2">.</span><span class="s1">delete</span><span class="s2">(</span><span class="s1">item</span><span class="s2">)</span>


            <span class="s0">for </span><span class="s1">row </span><span class="s0">in </span><span class="s1">filtered_data</span><span class="s2">:</span>
                <span class="s1">treeview</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s3">&quot;&quot;</span><span class="s2">, </span><span class="s3">&quot;end&quot;</span><span class="s2">, </span><span class="s1">values</span><span class="s2">=</span><span class="s1">row</span><span class="s2">)</span>



        <span class="s1">show_report_button </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">reports_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Show Report&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">show_selected_report</span><span class="s2">)</span>
        <span class="s1">show_report_button</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

    <span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e</span><span class="s2">:</span>
        <span class="s1">print</span><span class="s2">(</span><span class="s3">f&quot;Error opening reports screen: </span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>
        <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s3">&quot;Error&quot;</span><span class="s2">, </span><span class="s3">&quot;Error opening reports screen. Please try again.&quot;</span><span class="s2">)</span>

<span class="s1">connection </span><span class="s2">= </span><span class="s1">psycopg2</span><span class="s2">.</span><span class="s1">connect</span><span class="s2">(**</span><span class="s1">db_params</span><span class="s2">)</span>
<span class="s1">cursor </span><span class="s2">= </span><span class="s1">connection</span><span class="s2">.</span><span class="s1">cursor</span><span class="s2">()</span>


<span class="s0">from </span><span class="s1">datetime </span><span class="s0">import </span><span class="s1">date</span>
<span class="s0">from </span><span class="s1">tkinter </span><span class="s0">import </span><span class="s1">simpledialog</span>


<span class="s0">def </span><span class="s1">get_next_policy_id</span><span class="s2">(</span><span class="s1">cursor</span><span class="s2">):</span>
    <span class="s1">query_get_next_policy_id </span><span class="s2">= </span><span class="s3">&quot;SELECT nextval('ins_policy_policy_id_seq')&quot;</span>
    <span class="s1">cursor</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">(</span><span class="s1">query_get_next_policy_id</span><span class="s2">)</span>
    <span class="s0">return </span><span class="s1">cursor</span><span class="s2">.</span><span class="s1">fetchone</span><span class="s2">()[</span><span class="s4">0</span><span class="s2">]</span>

<span class="s0">from </span><span class="s1">tkinter </span><span class="s0">import </span><span class="s1">ttk</span>

<span class="s0">from </span><span class="s1">tkinter </span><span class="s0">import </span><span class="s1">ttk</span>

<span class="s0">import </span><span class="s1">tkinter </span><span class="s0">as </span><span class="s1">tk</span>
<span class="s0">from </span><span class="s1">tkinter </span><span class="s0">import </span><span class="s1">ttk</span><span class="s2">, </span><span class="s1">simpledialog</span><span class="s2">, </span><span class="s1">messagebox</span>
<span class="s0">from </span><span class="s1">datetime </span><span class="s0">import </span><span class="s1">date</span>
<span class="s0">import </span><span class="s1">psycopg2</span>



<span class="s0">def </span><span class="s1">enter_sales</span><span class="s2">():</span>
    <span class="s0">try</span><span class="s2">:</span>

        <span class="s1">connection </span><span class="s2">= </span><span class="s1">psycopg2</span><span class="s2">.</span><span class="s1">connect</span><span class="s2">(**</span><span class="s1">db_params</span><span class="s2">)</span>
        <span class="s1">cursor </span><span class="s2">= </span><span class="s1">connection</span><span class="s2">.</span><span class="s1">cursor</span><span class="s2">()</span>


        <span class="s1">query_get_next_sales_id </span><span class="s2">= </span><span class="s3">&quot;SELECT nextval('sales_sales_id_seq')&quot;</span>
        <span class="s1">cursor</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">(</span><span class="s1">query_get_next_sales_id</span><span class="s2">)</span>
        <span class="s1">next_sales_id </span><span class="s2">= </span><span class="s1">cursor</span><span class="s2">.</span><span class="s1">fetchone</span><span class="s2">()[</span><span class="s4">0</span><span class="s2">]</span>


        <span class="s0">while </span><span class="s1">check_sales_id_exists</span><span class="s2">(</span><span class="s1">cursor</span><span class="s2">, </span><span class="s1">next_sales_id</span><span class="s2">):</span>
            <span class="s1">next_sales_id </span><span class="s2">+= </span><span class="s4">1</span>


        <span class="s1">enter_sales_screen </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">Toplevel</span><span class="s2">(</span><span class="s1">welcome_screen</span><span class="s2">)</span>
        <span class="s1">enter_sales_screen</span><span class="s2">.</span><span class="s1">title</span><span class="s2">(</span><span class="s3">&quot;Enter Sales&quot;</span><span class="s2">)</span>


        <span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">enter_sales_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Customer ID:&quot;</span><span class="s2">).</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
        <span class="s1">customer_id_entry </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">enter_sales_screen</span><span class="s2">)</span>
        <span class="s1">customer_id_entry</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">enter_sales_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Branch ID:&quot;</span><span class="s2">).</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
        <span class="s1">branch_id_entry </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">enter_sales_screen</span><span class="s2">)</span>
        <span class="s1">branch_id_entry</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">enter_sales_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Insurance Company ID:&quot;</span><span class="s2">).</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
        <span class="s1">ins_company_id_entry </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">enter_sales_screen</span><span class="s2">)</span>
        <span class="s1">ins_company_id_entry</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">enter_sales_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Sales Date (YYYY-MM-DD):&quot;</span><span class="s2">).</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">9</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
        <span class="s1">sales_date_entry </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">enter_sales_screen</span><span class="s2">)</span>
        <span class="s1">sales_date_entry</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">9</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">policy_types </span><span class="s2">= [</span>
            <span class="s3">&quot;health&quot;</span><span class="s2">, </span><span class="s3">&quot;electronic device&quot;</span><span class="s2">, </span><span class="s3">&quot;corporate&quot;</span><span class="s2">, </span><span class="s3">&quot;common ground&quot;</span><span class="s2">,</span>
            <span class="s3">&quot;travel&quot;</span><span class="s2">, </span><span class="s3">&quot;corporate&quot;</span><span class="s2">, </span><span class="s3">&quot;vehicle&quot;</span><span class="s2">, </span><span class="s3">&quot;house&quot;</span><span class="s2">, </span><span class="s3">&quot;personal accident&quot;</span>
        <span class="s2">]</span>
        <span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">enter_sales_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Choose Policy Type:&quot;</span><span class="s2">).</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
        <span class="s1">policy_type_var </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">StringVar</span><span class="s2">(</span><span class="s1">value</span><span class="s2">=</span><span class="s1">policy_types</span><span class="s2">[</span><span class="s4">0</span><span class="s2">])</span>
        <span class="s1">policy_type_combobox </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Combobox</span><span class="s2">(</span><span class="s1">enter_sales_screen</span><span class="s2">, </span><span class="s1">textvariable</span><span class="s2">=</span><span class="s1">policy_type_var</span><span class="s2">, </span><span class="s1">values</span><span class="s2">=</span><span class="s1">policy_types</span><span class="s2">)</span>
        <span class="s1">policy_type_combobox</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>


        <span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">enter_sales_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Insurance Commission:&quot;</span><span class="s2">).</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">4</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
        <span class="s1">insurance_commission_entry </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">enter_sales_screen</span><span class="s2">)</span>
        <span class="s1">insurance_commission_entry</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">4</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">enter_sales_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Insurance Risk:&quot;</span><span class="s2">).</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
        <span class="s1">insurance_risk_entry </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">enter_sales_screen</span><span class="s2">)</span>
        <span class="s1">insurance_risk_entry</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">enter_sales_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Insurance Premium:&quot;</span><span class="s2">).</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">6</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
        <span class="s1">insurance_premium_entry </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">enter_sales_screen</span><span class="s2">)</span>
        <span class="s1">insurance_premium_entry</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">6</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">enter_sales_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Earthquake Coverage (true or false):&quot;</span><span class="s2">).</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">7</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
        <span class="s1">earthquake_coverage_entry </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">enter_sales_screen</span><span class="s2">)</span>
        <span class="s1">earthquake_coverage_entry</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">7</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">enter_sales_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Flood Coverage (true or false):&quot;</span><span class="s2">).</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">8</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
        <span class="s1">flood_coverage_entry </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">enter_sales_screen</span><span class="s2">)</span>
        <span class="s1">flood_coverage_entry</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">8</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>


        <span class="s1">submit_button </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">enter_sales_screen</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Submit&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s0">lambda</span><span class="s2">: </span><span class="s1">submit_sales_info</span><span class="s2">(</span>
            <span class="s1">next_sales_id</span><span class="s2">, </span><span class="s1">customer_id_entry</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(), </span><span class="s1">branch_id_entry</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(), </span><span class="s1">ins_company_id_entry</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(),</span>
            <span class="s1">policy_type_var</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(), </span><span class="s1">insurance_commission_entry</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(), </span><span class="s1">insurance_risk_entry</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(),</span>
            <span class="s1">insurance_premium_entry</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(), </span><span class="s1">earthquake_coverage_entry</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(), </span><span class="s1">flood_coverage_entry</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(),</span>
            <span class="s1">sales_date_entry</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(), </span><span class="s1">cursor</span>
        <span class="s2">))</span>
        <span class="s1">submit_button</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">11</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">10</span><span class="s2">)</span>
        <span class="s1">submit_button</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">11</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">10</span><span class="s2">)</span>

    <span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e</span><span class="s2">:</span>
        <span class="s1">print</span><span class="s2">(</span><span class="s3">f&quot;Error entering sales: </span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>

<span class="s0">def </span><span class="s1">submit_sales_info</span><span class="s2">(</span><span class="s1">sales_id</span><span class="s2">, </span><span class="s1">customer_id</span><span class="s2">, </span><span class="s1">branch_id</span><span class="s2">, </span><span class="s1">ins_company_id</span><span class="s2">, </span><span class="s1">policy_type</span><span class="s2">,</span>
                      <span class="s1">insurance_commission</span><span class="s2">, </span><span class="s1">insurance_risk</span><span class="s2">, </span><span class="s1">insurance_premium</span><span class="s2">,</span>
                      <span class="s1">earthquake_coverage</span><span class="s2">, </span><span class="s1">flood_coverage</span><span class="s2">, </span><span class="s1">sales_date</span><span class="s2">, </span><span class="s1">cursor</span><span class="s2">):</span>
    <span class="s0">try</span><span class="s2">:</span>

        <span class="s1">connection </span><span class="s2">= </span><span class="s1">psycopg2</span><span class="s2">.</span><span class="s1">connect</span><span class="s2">(**</span><span class="s1">db_params</span><span class="s2">)</span>
        <span class="s1">cursor </span><span class="s2">= </span><span class="s1">connection</span><span class="s2">.</span><span class="s1">cursor</span><span class="s2">()</span>


        <span class="s0">while </span><span class="s1">check_sales_id_exists</span><span class="s2">(</span><span class="s1">cursor</span><span class="s2">, </span><span class="s1">sales_id</span><span class="s2">):</span>
            <span class="s1">sales_id </span><span class="s2">+= </span><span class="s4">1</span>


        <span class="s0">if not </span><span class="s1">check_customer_exist</span><span class="s2">(</span><span class="s1">cursor</span><span class="s2">, </span><span class="s1">customer_id</span><span class="s2">):</span>
            <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s3">&quot;Error&quot;</span><span class="s2">, </span><span class="s3">f&quot;Customer with ID </span><span class="s0">{</span><span class="s1">customer_id</span><span class="s0">} </span><span class="s3">does not exist.&quot;</span><span class="s2">)</span>
            <span class="s0">return</span>


        <span class="s0">if not </span><span class="s1">check_branch_exist</span><span class="s2">(</span><span class="s1">cursor</span><span class="s2">, </span><span class="s1">branch_id</span><span class="s2">):</span>
            <span class="s1">messagebox</span><span class="s2">.</span><span class="s1">showerror</span><span class="s2">(</span><span class="s3">&quot;Error&quot;</span><span class="s2">, </span><span class="s3">f&quot;Branch with ID </span><span class="s0">{</span><span class="s1">branch_id</span><span class="s0">} </span><span class="s3">does not exist.&quot;</span><span class="s2">)</span>
            <span class="s0">return</span>


        <span class="s1">next_policy_id </span><span class="s2">= </span><span class="s1">get_next_sequence_value</span><span class="s2">(</span><span class="s1">cursor</span><span class="s2">, </span><span class="s3">'ins_policy_policy_id_seq'</span><span class="s2">)</span>

        <span class="s1">insert_into_ins_policy</span><span class="s2">(</span><span class="s1">cursor</span><span class="s2">, </span><span class="s1">next_policy_id</span><span class="s2">, </span><span class="s1">policy_type</span><span class="s2">, </span><span class="s1">ins_company_id</span><span class="s2">, </span><span class="s1">customer_id</span><span class="s2">,</span>
                               <span class="s1">insurance_commission</span><span class="s2">, </span><span class="s1">insurance_risk</span><span class="s2">, </span><span class="s1">sales_date</span><span class="s2">,</span>
                               <span class="s1">insurance_premium</span><span class="s2">, </span><span class="s1">earthquake_coverage</span><span class="s2">, </span><span class="s1">flood_coverage</span><span class="s2">)</span>


        <span class="s1">query_insert_sales </span><span class="s2">= </span><span class="s3">&quot;&quot;&quot; 
        INSERT INTO sales (sales_id, customer_id, branch_id, salesdate, ins_company_id) 
        VALUES (%s, %s, %s, %s, %s) 
        &quot;&quot;&quot;</span>
        <span class="s1">cursor</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">(</span><span class="s1">query_insert_sales</span><span class="s2">, (</span><span class="s1">sales_id</span><span class="s2">, </span><span class="s1">customer_id</span><span class="s2">, </span><span class="s1">branch_id</span><span class="s2">, </span><span class="s1">sales_date</span><span class="s2">, </span><span class="s1">ins_company_id</span><span class="s2">))</span>

        <span class="s1">connection</span><span class="s2">.</span><span class="s1">commit</span><span class="s2">()</span>


        <span class="s1">print</span><span class="s2">(</span><span class="s3">f&quot;Newly inserted sales_id: </span><span class="s0">{</span><span class="s1">sales_id</span><span class="s0">}</span><span class="s3">, sales_date: </span><span class="s0">{</span><span class="s1">sales_date</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>


        <span class="s1">cursor</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>
        <span class="s1">connection</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>
    <span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e</span><span class="s2">:</span>
        <span class="s1">print</span><span class="s2">(</span><span class="s3">f&quot;Error entering sales: </span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>

<span class="s0">def </span><span class="s1">get_next_sequence_value</span><span class="s2">(</span><span class="s1">cursor</span><span class="s2">, </span><span class="s1">sequence_name</span><span class="s2">):</span>
    <span class="s0">try</span><span class="s2">:</span>
        <span class="s1">query_get_next_value </span><span class="s2">= </span><span class="s3">f&quot;SELECT nextval('</span><span class="s0">{</span><span class="s1">sequence_name</span><span class="s0">}</span><span class="s3">')&quot;</span>
        <span class="s1">cursor</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">(</span><span class="s1">query_get_next_value</span><span class="s2">)</span>
        <span class="s0">return </span><span class="s1">cursor</span><span class="s2">.</span><span class="s1">fetchone</span><span class="s2">()[</span><span class="s4">0</span><span class="s2">]</span>
    <span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e</span><span class="s2">:</span>
        <span class="s1">print</span><span class="s2">(</span><span class="s3">f&quot;Error getting next sequence value: </span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>

<span class="s0">class </span><span class="s1">PolicyTypeDialog</span><span class="s2">(</span><span class="s1">simpledialog</span><span class="s2">.</span><span class="s1">Dialog</span><span class="s2">):</span>
    <span class="s0">def </span><span class="s1">body</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">master</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">policy_types </span><span class="s2">= [</span>
            <span class="s3">&quot;health&quot;</span><span class="s2">, </span><span class="s3">&quot;electronic device&quot;</span><span class="s2">, </span><span class="s3">&quot;corporate&quot;</span><span class="s2">, </span><span class="s3">&quot;common ground&quot;</span><span class="s2">,</span>
            <span class="s3">&quot;travel&quot;</span><span class="s2">, </span><span class="s3">&quot;corporate&quot;</span><span class="s2">, </span><span class="s3">&quot;vehicle&quot;</span><span class="s2">, </span><span class="s3">&quot;house&quot;</span><span class="s2">, </span><span class="s3">&quot;personal accident&quot;</span>
        <span class="s2">]</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">listbox </span><span class="s2">= </span><span class="s1">Listbox</span><span class="s2">(</span><span class="s1">master</span><span class="s2">, </span><span class="s1">selectmode</span><span class="s2">=</span><span class="s3">&quot;single&quot;</span><span class="s2">, </span><span class="s1">height</span><span class="s2">=</span><span class="s1">len</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">policy_types</span><span class="s2">))</span>
        <span class="s0">for </span><span class="s1">policy_type </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">policy_types</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">listbox</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s3">&quot;end&quot;</span><span class="s2">, </span><span class="s1">policy_type</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">listbox</span><span class="s2">.</span><span class="s1">pack</span><span class="s2">()</span>

        <span class="s0">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">listbox</span>

    <span class="s0">def </span><span class="s1">apply</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">selection </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">listbox</span><span class="s2">.</span><span class="s1">curselection</span><span class="s2">()</span>
        <span class="s0">if </span><span class="s1">selection</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">result </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">policy_types</span><span class="s2">[</span><span class="s1">selection</span><span class="s2">[</span><span class="s4">0</span><span class="s2">]]</span>

<span class="s0">def </span><span class="s1">choose_policy_type</span><span class="s2">():</span>
    <span class="s1">dialog </span><span class="s2">= </span><span class="s1">PolicyTypeDialog</span><span class="s2">(</span><span class="s1">welcome_screen</span><span class="s2">, </span><span class="s3">&quot;Choose Policy Type&quot;</span><span class="s2">)</span>
    <span class="s1">selected_policy_type </span><span class="s2">= </span><span class="s1">dialog</span><span class="s2">.</span><span class="s1">result</span>
    <span class="s0">return </span><span class="s1">selected_policy_type</span>

<span class="s0">def </span><span class="s1">insert_into_ins_policy</span><span class="s2">(</span><span class="s1">cursor</span><span class="s2">, </span><span class="s1">policy_id</span><span class="s2">, </span><span class="s1">policy_type</span><span class="s2">, </span><span class="s1">ins_company_id</span><span class="s2">, </span><span class="s1">customer_id</span><span class="s2">,</span>
                           <span class="s1">ins_commusion</span><span class="s2">, </span><span class="s1">ins_risk</span><span class="s2">, </span><span class="s1">start_date</span><span class="s2">,</span>
                           <span class="s1">ins_premium</span><span class="s2">, </span><span class="s1">earthquake_cov</span><span class="s2">, </span><span class="s1">flood_cov</span><span class="s2">):</span>

    <span class="s1">query_insert_ins_policy </span><span class="s2">= </span><span class="s3">&quot;&quot;&quot; 
    INSERT INTO ins_policy (policy_id, policy_type, ins_commusion, ins_risk, start_date, ins_company_id, ins_premium, earthquake_cov, flood_cov, customer_id) 
    VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s) 
    &quot;&quot;&quot;</span>
    <span class="s1">cursor</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">(</span><span class="s1">query_insert_ins_policy</span><span class="s2">, (</span><span class="s1">policy_id</span><span class="s2">, </span><span class="s1">policy_type</span><span class="s2">, </span><span class="s1">ins_commusion</span><span class="s2">, </span><span class="s1">ins_risk</span><span class="s2">, </span><span class="s1">start_date</span><span class="s2">, </span><span class="s1">ins_company_id</span><span class="s2">, </span><span class="s1">ins_premium</span><span class="s2">, </span><span class="s1">earthquake_cov</span><span class="s2">, </span><span class="s1">flood_cov</span><span class="s2">, </span><span class="s1">customer_id</span><span class="s2">))</span>

<span class="s0">def </span><span class="s1">check_sales_id_exists</span><span class="s2">(</span><span class="s1">cursor</span><span class="s2">, </span><span class="s1">sales_id</span><span class="s2">):</span>
    <span class="s1">query_check_sales_id </span><span class="s2">= </span><span class="s3">&quot;SELECT COUNT(*) FROM sales WHERE sales_id = %s&quot;</span>
    <span class="s1">cursor</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">(</span><span class="s1">query_check_sales_id</span><span class="s2">, (</span><span class="s1">sales_id</span><span class="s2">,))</span>
    <span class="s0">return </span><span class="s1">cursor</span><span class="s2">.</span><span class="s1">fetchone</span><span class="s2">()[</span><span class="s4">0</span><span class="s2">] &gt; </span><span class="s4">0</span>


<span class="s0">def </span><span class="s1">check_customer_exist</span><span class="s2">(</span><span class="s1">cursor</span><span class="s2">, </span><span class="s1">customer_id</span><span class="s2">):</span>
    <span class="s1">query_check_customer </span><span class="s2">= </span><span class="s3">&quot;SELECT COUNT(*) FROM customer WHERE customer_id = %s&quot;</span>
    <span class="s1">cursor</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">(</span><span class="s1">query_check_customer</span><span class="s2">, (</span><span class="s1">customer_id</span><span class="s2">,))</span>
    <span class="s0">return </span><span class="s1">cursor</span><span class="s2">.</span><span class="s1">fetchone</span><span class="s2">()[</span><span class="s4">0</span><span class="s2">] &gt; </span><span class="s4">0</span>


<span class="s0">def </span><span class="s1">check_branch_exist</span><span class="s2">(</span><span class="s1">cursor</span><span class="s2">, </span><span class="s1">branch_id</span><span class="s2">):</span>
    <span class="s1">query_check_branch </span><span class="s2">= </span><span class="s3">&quot;SELECT COUNT(*) FROM branch WHERE branch_id = %s&quot;</span>
    <span class="s1">cursor</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">(</span><span class="s1">query_check_branch</span><span class="s2">, (</span><span class="s1">branch_id</span><span class="s2">,))</span>
    <span class="s0">return </span><span class="s1">cursor</span><span class="s2">.</span><span class="s1">fetchone</span><span class="s2">()[</span><span class="s4">0</span><span class="s2">] &gt; </span><span class="s4">0</span>

<span class="s0">def </span><span class="s1">check_policy_id_exists</span><span class="s2">(</span><span class="s1">cursor</span><span class="s2">, </span><span class="s1">policy_id</span><span class="s2">):</span>
    <span class="s1">query_check_policy_id </span><span class="s2">= </span><span class="s3">&quot;SELECT COUNT(*) FROM ins_policy WHERE policy_id = %s&quot;</span>
    <span class="s1">cursor</span><span class="s2">.</span><span class="s1">execute</span><span class="s2">(</span><span class="s1">query_check_policy_id</span><span class="s2">, (</span><span class="s1">policy_id</span><span class="s2">,))</span>
    <span class="s0">return </span><span class="s1">cursor</span><span class="s2">.</span><span class="s1">fetchone</span><span class="s2">()[</span><span class="s4">0</span><span class="s2">] &gt; </span><span class="s4">0</span>


<span class="s1">root </span><span class="s2">= </span><span class="s1">tk</span><span class="s2">.</span><span class="s1">Tk</span><span class="s2">()</span>
<span class="s1">root</span><span class="s2">.</span><span class="s1">title</span><span class="s2">(</span><span class="s3">&quot;Login Screen&quot;</span><span class="s2">)</span>


<span class="s1">username_label </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">root</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Username:&quot;</span><span class="s2">)</span>
<span class="s1">username_label</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
<span class="s1">username_entry </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">root</span><span class="s2">)</span>
<span class="s1">username_entry</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

<span class="s1">password_label </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Label</span><span class="s2">(</span><span class="s1">root</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Password:&quot;</span><span class="s2">)</span>
<span class="s1">password_label</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">sticky</span><span class="s2">=</span><span class="s3">&quot;E&quot;</span><span class="s2">)</span>
<span class="s1">password_entry </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Entry</span><span class="s2">(</span><span class="s1">root</span><span class="s2">, </span><span class="s1">show</span><span class="s2">=</span><span class="s3">&quot;*&quot;</span><span class="s2">)</span>
<span class="s1">password_entry</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">padx</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

<span class="s1">login_button </span><span class="s2">= </span><span class="s1">ttk</span><span class="s2">.</span><span class="s1">Button</span><span class="s2">(</span><span class="s1">root</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s3">&quot;Login&quot;</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">login_clicked</span><span class="s2">)</span>
<span class="s1">login_button</span><span class="s2">.</span><span class="s1">grid</span><span class="s2">(</span><span class="s1">row</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">column</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">columnspan</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">pady</span><span class="s2">=</span><span class="s4">10</span><span class="s2">)</span>



<span class="s1">login_screen </span><span class="s2">= </span><span class="s1">root</span>

<span class="s1">root</span><span class="s2">.</span><span class="s1">mainloop</span><span class="s2">()</span>
</pre>
</body>
</html>